(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{SST1:function(e,t,i){"use strict";i.r(t);var n=i("D57K"),s=i("5/c3"),o=i("LR82"),a=i("z5yO"),r=i("KLQV"),l=i("1C3z"),c=i("OeRG"),d=i("Qc/f"),p=i("r4gC"),h=function(){function e(){}return e.prototype.agInit=function(e){this.params=e},e.prototype.refresh=function(e){return!0},e.prototype.deletePermission=function(){this.params.onDelete(this.params.data)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["app-permissions-actions"]],decls:4,vars:0,consts:[[1,"actions-component"],["matRipple","","matTooltip","Delete",1,"like-button","highlight",3,"click"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.ec("click",(function(){return t.deletePermission()})),l.Wb(2,"mat-icon"),l.Pc(3,"delete"),l.Vb(),l.Vb(),l.Vb())},directives:[c.q,d.a,p.a],styles:[""]}),e}(),u=i("zsK+"),m=i("JzAw"),b=i("BLjT"),f=i("SNUn"),y=i("2pW/"),g=i("9HSk"),C=i("G6Ml");i.d(t,"PermissionsComponent",(function(){return k}));var k=function(){function e(e,t,i,n,s){this.dialogRef=e,this.router=t,this.route=i,this.permissionsService=n,this.snackBar=s,this.columnDefs=[{headerName:"ID",field:"Id",width:70,headerClass:"dense",cellClass:"id-action no-padding no-outline",cellRenderer:"idFieldComponent",sortable:!0,filter:"agTextColumnFilter",valueGetter:this.idValueGetter},{headerName:"Name",field:"Title",flex:2,minWidth:250,cellClass:"primary-action highlight",sortable:!0,filter:"agTextColumnFilter",onCellClicked:this.editPermission.bind(this)},{width:40,cellClass:"secondary-action no-padding",cellRenderer:"permissionsActionsComponent",cellRendererParams:{onDelete:this.deletePermission.bind(this)}},{headerName:"Identity",field:"Identity",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Condition",field:"Condition",flex:2,minWidth:250,cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"},{headerName:"Grant",field:"Grant",width:70,headerClass:"dense",cellClass:"no-outline",sortable:!0,filter:"agTextColumnFilter"}],this.frameworkComponents={idFieldComponent:m.a,permissionsActionsComponent:h},this.modules=r.a,this.subscription=new o.a,this.hasChild=!!this.route.snapshot.firstChild}return e.prototype.ngOnInit=function(){this.targetType=parseInt(this.route.snapshot.paramMap.get("type"),10),this.keyType=this.route.snapshot.paramMap.get("keyType"),this.key=this.route.snapshot.paramMap.get("key"),this.fetchPermissions(),this.refreshOnChildClosed()},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe(),this.subscription=null},e.prototype.closeDialog=function(){this.dialogRef.close()},e.prototype.idValueGetter=function(e){var t=e.data;return"ID: "+t.Id+"\nGUID: "+t.Guid},e.prototype.fetchPermissions=function(){var e=this;this.permissionsService.getAll(this.targetType,this.keyType,this.key).subscribe((function(t){e.permissions=t}))},e.prototype.editPermission=function(e){var t,i,s;if(null===e){var o=void 0,a=Object.keys(u.a.metadata);try{for(var r=Object(n.i)(a),l=r.next();!l.done;l=r.next()){var c=l.value;if(u.a.metadata[c].type===this.targetType){o=u.a.metadata[c].target;break}}}catch(d){t={error:d}}finally{try{l&&!l.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}s={items:[{ContentTypeName:u.a.contentTypes.permissions,For:Object(n.a)(Object(n.a)(Object(n.a)({Target:o},this.keyType===u.a.keyTypes.guid&&{Guid:this.key}),this.keyType===u.a.keyTypes.number&&{Number:parseInt(this.key,10)}),this.keyType===u.a.keyTypes.string&&{String:this.key})}]}}else s={items:[{EntityId:e.data.Id.toString()}]};this.router.navigate(["edit/"+JSON.stringify(s)],{relativeTo:this.route})},e.prototype.deletePermission=function(e){var t=this;confirm("Delete '"+e.Title+"' ("+e.Id+")?")&&(this.snackBar.open("Deleting..."),this.permissionsService.delete(e.Id).subscribe((function(){t.snackBar.open("Deleted",null,{duration:2e3}),t.fetchPermissions()})))},e.prototype.refreshOnChildClosed=function(){var e=this;this.subscription.add(this.router.events.pipe(Object(a.a)((function(e){return e instanceof s.b}))).subscribe((function(t){var i=e.hasChild;e.hasChild=!!e.route.snapshot.firstChild,!e.hasChild&&i&&e.fetchPermissions()})))},e.\u0275fac=function(t){return new(t||e)(l.Qb(b.h),l.Qb(s.c),l.Qb(s.a),l.Qb(f.a),l.Qb(y.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-permissions"]],decls:13,vars:10,consts:[["mat-dialog-title",""],[1,"dialog-title-box"],["mat-icon-button","","matTooltip","Close dialog",3,"click"],[1,"grid-wrapper"],[1,"ag-theme-material",3,"rowData","columnDefs","modules","frameworkComponents","enableCellTextSelection","suppressScrollOnNewData","animateRows","accentedSort","valueCache","headerHeight"],["mat-fab","","mat-elevation-z24","","matTooltip","Create a new permission",1,"grid-fab",3,"click"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"div"),l.Pc(3,"Permissions"),l.Vb(),l.Wb(4,"button",2),l.ec("click",(function(){return t.closeDialog()})),l.Wb(5,"mat-icon"),l.Pc(6,"close"),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Rb(7,"router-outlet"),l.Wb(8,"div",3),l.Rb(9,"ag-grid-angular",4),l.Wb(10,"button",5),l.ec("click",(function(){return t.editPermission(null)})),l.Wb(11,"mat-icon"),l.Pc(12,"add"),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Bb(9),l.qc("rowData",t.permissions)("columnDefs",t.columnDefs)("modules",t.modules)("frameworkComponents",t.frameworkComponents)("enableCellTextSelection",!0)("suppressScrollOnNewData",!0)("animateRows",!0)("accentedSort",!0)("valueCache",!0)("headerHeight",32))},directives:[b.i,g.b,d.a,p.a,s.h,C.a],styles:["ag-grid-angular.ag-theme-material[_ngcontent-%COMP%]{height:calc(100vh - 176px)}@media (max-width:600px){ag-grid-angular.ag-theme-material[_ngcontent-%COMP%]{height:calc(100vh - 128px)}}"]}),e}()}}]);
//# sourceMappingURL=42.js.map