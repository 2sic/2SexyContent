!function(){window.$2sxc||(window.$2sxc=function(a,b){if("object"==typeof a)return window.$2sxc.autoFind(a);var c=a+":"+b;if(b||(b=a),$2sxc._data[c]||($2sxc._data[c]={}),$2sxc._controllers[c])return $2sxc._controllers[c];var d=$2sxc._controllers[c]={serviceScopes:["app","app-api","app-query","app-content","eav","view","dnn"],serviceRoot:$.ServicesFramework(a).getServiceRoot("2sxc"),resolveServiceUrl:function(a){var b=a.split("/")[0].toLowerCase();return-1===d.serviceScopes.indexOf(b)?a:d.serviceRoot+b+"/"+a.substring(a.indexOf("/")+1)},data:{sourceUrl:function(b){var c=window.location.href;return c.indexOf("#")&&(c=c.substr(0,c.indexOf("#"))),c+=(-1!==window.location.href.indexOf("?")?"&":"?")+"mid="+a+"&standalone=true&popUp=true&type=data","string"==typeof b&&(c+="&"+b),c},"in":{},List:[],controller:null,load:function(a){return a&&a.List?(d.data.setData(a),d.data):(a||(a={}),a.url||(a.url=d.data.sourceUrl()),a.origSuccess=a.success,a.success=function(b){for(var c in b)null!==b[c].List&&(d.data["in"][c]=b[c],d.data["in"][c].name=c);d.data["in"].Default&&(d.List=d.data["in"].Default.List),a.origSuccess&&a.origSuccess(d.data),d.isLoaded=!0,d.lastRefresh=new Date,d.data._triggerLoaded()},a.error=function(a){alert(JSON.parse(a.responseText).error)},d.data.source=a,d.data.reload())},reload:function(a){return a&&(d.data.source.success=a),$.ajax(d.data.source),d.data},on:function(a,b){return $(d.data).bind("2scLoad",b)[0]._triggerLoaded()},_triggerLoaded:function(){return d.isLoaded?$(d.data).trigger("2scLoad",[d.data])[0]:d.data},one:function(a,b){return d.isLoaded?(b({},d.data),d.data):$(d.data).one("2scLoad",b)[0]}},id:a,cbid:b,cacheKey:b,source:null,isLoaded:!1,lastRefresh:null,manage:null,isEditMode:function(){return d.manage&&d.manage.isEditMode()},webApi:{get:function(a,b,c,e){return d.webApi._action(a,b,c,e,"GET")},post:function(a,b,c,e){return d.webApi._action(a,b,c,e,"POST")},"delete":function(a,b,c,e){return d.webApi._action(a,b,c,e,"DELETE")},put:function(a,b,c,e){return d.webApi._action(a,b,c,e,"PUT")},_action:function(b,c,e,f,g){if("object"!=typeof c&&"undefined"!=typeof c&&(c={id:c}),"string"==typeof b){var h=b.split("/"),i=h[0],j=h[1];(""===i||""===j)&&alert("Error: controller or action not defined. Will continue with likely errors."),b={controller:i,action:j,params:c,data:e,url:h.length>2?b:null,preventAutoFail:f}}var k={method:null===g?"POST":g,params:null,preventAutoFail:!1};b=$.extend({},k,b);var l=$.ServicesFramework(a),m=$.ajax({type:b.method,dataType:b.dataType||"json",async:!0,data:JSON.stringify(b.data),contentType:"application/json",url:d.webApi.getActionUrl(b),beforeSend:l.setModuleHeaders});return b.preventAutoFail||m.fail(d.showDetailedHttpError),m},getActionUrl:function(b){var c=$.ServicesFramework(a),e=b.url?d.resolveServiceUrl(b.url):c.getServiceRoot("2sxc")+"app-api/"+b.controller+"/"+b.action;return e+(null===b.params?"":"?"+$.param(b.params))}},showDetailedHttpError:function(a){if(window.console&&console.log(a),404===a.status&&a.config&&a.config.url&&a.config.url.indexOf("/dist/i18n/")>-1)return window.console&&console.log("just fyi: failed to load language resource; will have to use default"),a;if(0!==a.status){var b="Had an error talking to the server (status "+a.status+").",c=a.responseText?JSON.parse(a.responseText):a.data;if(c){var d=c.Message;d&&(b+="\nMessage: "+d);var e=c.MessageDetail||c.ExceptionMessage;e&&(b+="\nDetail: "+e),e&&0===e.indexOf("No action was found")&&(e.indexOf("that matches the name")>0?b+="\n\nTip from 2sxc: you probably got the action-name wrong in your JS.":e.indexOf("that matches the request.")>0&&(b+="\n\nTip from 2sxc: Seems like the parameters are the wrong amount or type.")),d&&0===d.indexOf("Controller")&&d.indexOf("not found")>0&&(b+="\n\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word 'controller' from the call in JS. To call a controller called 'DemoController' only use 'Demo'.")}b+="\n\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug",alert(b)}}};return d.manage=$2sxc.getManageController?$2sxc.getManageController(d):null,d.data.controller=d,d},$2sxc._controllers={},$2sxc.metaName="The 2sxc Controller object",$2sxc.metaVersion="08.03.07",$2sxc.beta={},$2sxc._data={},$2sxc.totalPopup={open:function(a,b){for(var c=1500,d=window;d!==window.top&&1600>c;)c++,d=d.parent;var e=document.createElement("div");e.setAttribute("style"," top: 0;left: 0;width: 100%;height: 100%; position:fixed; z-index:"+c),document.body.appendChild(e);var f=document.createElement("iframe");f.setAttribute("allowtransparency","true"),f.setAttribute("style","top: 0;left: 0;width: 100%;height: 100%;"),f.setAttribute("src",a),e.appendChild(f),document.body.className+=" sxc-popup-open",$2sxc.totalPopup.frame=f,$2sxc.totalPopup.callback=b},close:function(){if($2sxc.totalPopup.frame){document.body.className=document.body.className.replace("sxc-popup-open","");var a=$2sxc.totalPopup.frame;a.parentNode.parentNode.removeChild(a.parentNode),$2sxc.totalPopup.callback()}},closeThis:function(){window.parent.$2sxc.totalPopup.close()}},$2sxc.urlParams={get:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)","i"),c=b.exec(location.search);if(null===c){var d=new RegExp("[#&]"+a+"=([^&#]*)","i");c=d.exec(location.hash)}if(null===c){var e=window.location.pathname.match(new RegExp("/"+a+"/([^/]+)","i"));null!==e&&e.length>1&&(c=e.reverse()[0])}else c=c[1];return null===c?"":decodeURIComponent(c.replace(/\+/g," "))},require:function(a){var b=$2sxc.urlParams.get(a);if(""===b){var c="Required parameter ("+a+") missing from url - cannot continue";throw alert(c),c}return b}},$2sxc.debug={load:"true"===$2sxc.urlParams.get("debug"),renameScript:function(a){return $2sxc.debug.load?a.replace(".min",""):a}},$2sxc.autoFind=function(a){var b=$(a).closest(".sc-content-block")[0];if(!b)return null;var c=b.getAttribute("data-cb-instance"),d=b.getAttribute("data-cb-id");return c&&d?$2sxc(c,d):null},$2sxc.system={finishUpgrade:function(a){var b=$2sxc(a),c=b.resolveServiceUrl("view/module/finishinstallation");$.ajax({type:"get",url:c,beforeSend:$.ServicesFramework(b.id).setModuleHeaders}).success(function(a){alert("Upgrade ok, restarting the CMS and reloading..."),location.reload()}),alert("starting upgrade. This could take a few minutes. You'll see an 'ok' when it's done. Please wait...")}})}();
//# sourceMappingURL=2sxc.api.min.js.map