/*! ToSic_ToSxc 2015-04-09 */

$2sxc.getManageController=function(a){var b=$(".DnnModule-"+a),c=$.parseJSON(b.find(".Mod2sxcC, .Mod2sxcappC").attr("data-2sxc")).manage,d=c.config;d.returnUrl=window.location.href;var e=c.isEditMode,f=($.ServicesFramework(a),{isEditMode:function(){return e},_toolbarConfig:d,_manageInfo:c,getLink:function(a){a=$.extend({},d,a);var b={ctl:"editcontentgroup",mid:a.moduleId,returnUrl:a.returnUrl};return a.cultureDimension&&null!=a.cultureDimension&&(b.cultureDimension=a.cultureDimension),"new"==a.action&&(b.editMode="New"),a.useModuleList?(b.sortOrder="new"==a.action?a.sortOrder+1:a.sortOrder,b.contentGroupId=a.contentGroupId):("new"!=a.action&&(b.entityId=a.entityId),a.attributeSetName&&(b.attributeSetName=a.attributeSetName)),a.prefill&&(b.prefill=JSON.stringify(a.prefill)),a.dialogUrl+(-1==a.dialogUrl.indexOf("?")?"?":"&")+$.param(b)},_openDialog:function(a){var b=f.getLink(a);window.dnnModal&&dnnModal.show?(b+=(-1==b.indexOf("?")?"?":"&")+"popUp=true",dnnModal.show(b,!0,550,950,!0,"")):window.location=b},action:function(a){f._getSelectorScope().saveTemplateId().then(function(){if("edit"==a.action||"new"==a.action)f._openDialog(a);else{if("add"!=a.action)throw"Action "+a.action+" not known.";f._getSelectorScope().addItem(a.sortOrder)}})},getButton:function(b){b.entity&&b.entity._2sxcEditInformation&&(b.entity._2sxcEditInformation.entityId&&(b.entityId=b.entity._2sxcEditInformation.entityId),null!=b.entity._2sxcEditInformation.sortOrder&&(b.sortOrder=b.entity._2sxcEditInformation.sortOrder,b.useModuleList=!0),delete b.entity);var c=$("<a />",{"class":"sc-"+b.action,onclick:"javascript:$2sxc("+a+").manage.action("+JSON.stringify(b)+");"}),d="Edit";switch(b.action){case"add":d="Add";break;case"new":d="New"}return"edit"==b.action&&(null==b.isPublished||1==b.isPublished?(c.addClass("sc-published"),d+=" (published)"):(c.addClass("sc-draft"),d+=" (unpublished)")),c.attr("title",d),c[0].outerHTML},getToolbar:function(a){var b=[];a.action&&(a=[a]),$.isArray(a)?b=a:(b=[$.extend({action:"edit"},a)],d.isList&&-1!=a.sortOrder&&(a.useModuleList&&b.push($.extend({action:"add"},a)),b.push($.extend({action:"new"},a))));for(var c=$("<ul />",{"class":"sc-menu",onclick:"javascript: var e = arguments[0] || window.event; e.stopPropagation();"}),e=0;e<b.length;e++)c.append($("<li />").append($(f.getButton(b[e]))));return c[0].outerHTML},_processToolbars:function(){$(".sc-menu[data-toolbar]",$(".DnnModule-"+a)).each(function(){var b=$.parseJSON($(this).attr("data-toolbar"));$(this).replaceWith($2sxc(a).manage.getToolbar(b))})},_getSelectorScope:function(){var b=document.querySelector(".DnnModule-"+a+" .sc-selector-wrapper");return angular.element(b).scope()}});return f};
//# sourceMappingURL=2sxc.api.manage.min.js.map