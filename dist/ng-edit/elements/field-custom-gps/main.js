!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(HTMLElement);e.EavCustomInputField=i;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i);e.EavCustomInputFieldObservable=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildTemplate=function(t,e){return t+"<style>\n"+e+"\n</style>"},e.parseLatLng=function(t){return JSON.parse(t.replace("latitude","lat").replace("longitude","lng"))},e.stringifyLatLng=function(t){return JSON.stringify(t).replace("lat","latitude").replace("lng","longitude")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultCoordinates={lat:47.17465989999999,lng:9.469142499999975}},function(t,e,n){n(4),t.exports=n(9)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=n(1),a=n(2),s=n(6),l=n(7),c=n(8),u=function(t){function e(){var e=t.call(this)||this;console.log("FieldCustomGps constructor called");return e.mapApiUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyDPhnNKpEg8FmY8nooE7Zwnue6SusxEnHE",e.fieldInitialized=!1,e.eventListeners=[],e}return r(e,t),e.prototype.connectedCallback=function(){if(console.log("FieldCustomGps connectedCallback called"),!this.fieldInitialized){this.fieldInitialized=!0,this.innerHTML=o.buildTemplate(s,l),this.latInput=this.querySelector("#lat"),this.lngInput=this.querySelector("#lng");var t=this.querySelector("#address-mask-container");this.iconSearch=this.querySelector("#icon-search");var e=this.querySelector("#formatted-address-container");this.mapContainer=this.querySelector("#map");var n=this.experimental.allInputTypeNames.map(function(t){return t.name});-1!==n.indexOf(this.connector.field.settings.LatField)&&(this.latFieldName=this.connector.field.settings.LatField),-1!==n.indexOf(this.connector.field.settings.LongField)&&(this.lngFieldName=this.connector.field.settings.LongField);var r=this.connector.field.settings.AddressMask||this.connector.field.settings["Address Mask"];if(this.addressMaskService=new c.FieldMaskService(r,this.experimental.formGroup.controls,null,null),console.log("FieldCustomGps addressMask:",r),r&&(t.classList.remove("hidden"),e.innerText=this.addressMaskService.resolve()),!!window.google)this.mapScriptLoaded();else{var i=document.createElement("script");i.src=this.mapApiUrl,i.onload=this.mapScriptLoaded.bind(this),this.appendChild(i)}}},e.prototype.mapScriptLoaded=function(){console.log("FieldCustomGps mapScriptLoaded called"),this.map=new google.maps.Map(this.mapContainer,{zoom:15,center:a.defaultCoordinates}),this.marker=new google.maps.Marker({position:a.defaultCoordinates,map:this.map,draggable:!0}),this.geocoder=new google.maps.Geocoder,this.connector.data.value?this.updateHtml(o.parseLatLng(this.connector.data.value)):this.updateHtml(a.defaultCoordinates);var t=this.onLatLngInputChange.bind(this);this.latInput.addEventListener("change",t),this.lngInput.addEventListener("change",t);var e=this.autoSelect.bind(this);this.iconSearch.addEventListener("click",e),this.eventListeners.push({element:this.latInput,type:"change",listener:t},{element:this.lngInput,type:"change",listener:t},{element:this.iconSearch,type:"click",listener:e}),this.marker.addListener("dragend",this.onMarkerDragend.bind(this))},e.prototype.updateHtml=function(t){this.latInput.value=t.lat?t.lat.toString():"",this.lngInput.value=t.lng?t.lng.toString():"",this.map.setCenter(t),this.marker.setPosition(t)},e.prototype.updateForm=function(t){this.connector.data.update(o.stringifyLatLng(t)),this.latFieldName&&this.experimental.updateField(this.latFieldName,t.lat),this.lngFieldName&&this.experimental.updateField(this.lngFieldName,t.lng)},e.prototype.onLatLngInputChange=function(){console.log("FieldCustomGps input changed");var t={lat:this.latInput.value.length>0?parseFloat(this.latInput.value):null,lng:this.lngInput.value.length>0?parseFloat(this.lngInput.value):null};this.updateHtml(t),this.updateForm(t)},e.prototype.autoSelect=function(){var t=this;console.log("FieldCustomGps geocoder called");var e=this.addressMaskService.resolve();this.geocoder.geocode({address:e},function(n,r){if(r===google.maps.GeocoderStatus.OK){var i=n[0].geometry.location,o={lat:i.lat(),lng:i.lng()};t.updateHtml(o),t.updateForm(o)}else alert("Could not locate address: "+e)})},e.prototype.onMarkerDragend=function(t){console.log("FieldCustomGps marker changed");var e={lat:t.latLng.lat(),lng:t.latLng.lng()};this.updateHtml(e),this.updateForm(e)},e.prototype.disconnectedCallback=function(){console.log("FieldCustomGps disconnectedCallback called"),window.google&&(google.maps.event.clearInstanceListeners(this.marker),google.maps.event.clearInstanceListeners(this.map)),this.eventListeners.forEach(function(t){var e=t.element,n=t.type,r=t.listener;e.removeEventListener(n,r)})},e}(i.EavExperimentalInputField);customElements.define("field-custom-gps",u)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(n(0).EavCustomInputField);e.EavExperimentalInputField=i;var o=function(){return function(){}}();e.ElementEventListener=o},function(t,e){t.exports='<div class="custom-gps-container">\r\n  <div class="map-info">\r\n    <div class="input-component">\r\n      <label for="lat">Lat:</label>\r\n      <input id="lat" type="number" step="0.001" />\r\n    </div>\r\n    &nbsp;\r\n    <div class="input-component">\r\n      <label for="lng">Lng:</label>\r\n      <input id="lng" type="number" step="0.001" />\r\n    </div>\r\n  </div>\r\n\r\n  <div id="address-mask-container" class="map-info hidden">\r\n    <a id="icon-search" class="btn">\r\n      <span class="eav-icon-search" icon="search"></span>\r\n    </a>\r\n    <span id="formatted-address-container"></span>\r\n  </div>\r\n\r\n  <div id="map" class="map-info__map"></div>\r\n</div>\r\n'},function(t,e){t.exports=".custom-gps-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n}\r\n\r\n.map-info {\r\n  flex: 0 0 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 4px;\r\n  padding-left: 10px;\r\n  border-bottom: 1px solid #e1e1e1;\r\n  background: white;\r\n}\r\n\r\n.map-info label,\r\n.map-info #icon-search {\r\n  margin-right: 8px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-size: 12px;\r\n  text-transform: uppercase;\r\n  padding: 4px;\r\n}\r\n\r\n.map-info input {\r\n  margin-right: 8px;\r\n  padding: 4px 16px;\r\n  border: none;\r\n  background: transparent;\r\n  outline: none !important;\r\n}\r\n\r\n.map-info__map {\r\n  flex: 1 1 auto;\r\n  width: 100%;\r\n  display: block;\r\n}\r\n\r\n.hidden {\r\n  display: none;\r\n}\r\n\r\n.btn {\r\n  border: 1px solid silver;\r\n  border-radius: 4px;\r\n}\r\n.btn:hover {\r\n  background-color: rgba(69, 79, 99, 0.08);\r\n  cursor: pointer;\r\n}\r\n\r\n.input-component {\r\n  display: flex;\r\n  background-color: rgba(69, 79, 99, 0.08);\r\n  padding: 4px;\r\n  border-radius: 4px 4px 0 0;\r\n  border-bottom: 1px solid silver;\r\n  margin: 8px 0;\r\n}\r\n.input-component:hover {\r\n  border-bottom: 1px solid #0087f4;\r\n}\r\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r){this.changeEvent=n,this.fields=[],this.findFields=/\[.*?\]/gi,this.unwrapField=/[\[\]]/gi,this.subscriptions=[],this.mask=t,this.model=e,this.fields=this.fieldList(),r&&(this.preClean=r),e&&n&&this.watchAllFields()}return t.prototype.resolve=function(){var t=this,e=this.mask;return this.fields.forEach(function(n,r){var i=t.model.hasOwnProperty(n)&&t.model[n]&&t.model[n].value?t.model[n].value:"",o=t.preClean(n,i);e=e.replace("["+n+"]",o)}),e},t.prototype.fieldList=function(){var t=this,e=[];if(!this.mask)return e;var n=this.mask.match(this.findFields);return n?n.forEach(function(n,r){var i=n.replace(t.unwrapField,"");e.push(i)}):e.push(this.mask),e},t.prototype.preClean=function(t,e){return e},t.prototype.onChange=function(){console.log("StringTemplatePickerComponent onChange called");var t=this.resolve();this.value!==t&&this.changeEvent(t),this.value=t},t.prototype.watchAllFields=function(){var t=this;console.log("StringTemplatePickerComponent watchAllFields called"),this.fields.forEach(function(e){var n=t.model[e].valueChanges.subscribe(function(e){return t.onChange()});t.subscriptions.push(n)})},t.prototype.destroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t}();e.FieldMaskService=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(1),a=n(2),s=n(10),l=n(11),c=function(t){function e(){var e=t.call(this)||this;return console.log("FieldCustomGpsPreview constructor called"),e}return r(e,t),e.prototype.connectedCallback=function(){var t=this;console.log("FieldCustomGpsPreview connectedCallback called"),this.innerHTML=o.buildTemplate(s,l),this.latContainer=this.querySelector("#lat-container"),this.lngContainer=this.querySelector("#lng-container"),this.connector.data.value?this.updateHtml(o.parseLatLng(this.connector.data.value)):this.updateHtml(a.defaultCoordinates),this.connector.data.onValueChange(function(e){if(e){var n=o.parseLatLng(e);t.updateHtml(n)}else t.updateHtml(a.defaultCoordinates)})},e.prototype.updateHtml=function(t){this.latContainer.innerText=t.lat?t.lat.toString():"",this.lngContainer.innerText=t.lng?t.lng.toString():""},e.prototype.disconnectedCallback=function(){console.log("FieldCustomGpsPreview disconnectedCallback called")},e}(i.EavCustomInputField);customElements.define("field-custom-gps-preview",c)},function(t,e){t.exports='Lat: <span id="lat-container"></span>, Lng: <span id="lng-container"></span>\r\n'},function(t,e){t.exports=""}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcHJvamVjdHMvc2hhcmVkL2Vhdi1jdXN0b20taW5wdXQtZmllbGQudHMiLCJ3ZWJwYWNrOi8vLy4vcHJvamVjdHMvZmllbGQtY3VzdG9tLWdwcy9zcmMvc2hhcmVkL2hlbHBlcnMudHMiLCJ3ZWJwYWNrOi8vLy4vcHJvamVjdHMvZmllbGQtY3VzdG9tLWdwcy9zcmMvc2hhcmVkL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly8vLi9wcm9qZWN0cy9maWVsZC1jdXN0b20tZ3BzL3NyYy9tYWluL21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vcHJvamVjdHMvZmllbGQtY3VzdG9tLWdwcy9zcmMvc2hhcmVkL21vZGVscy50cyIsIndlYnBhY2s6Ly8vLi9wcm9qZWN0cy9maWVsZC1jdXN0b20tZ3BzL3NyYy9tYWluL21haW4uaHRtbCIsIndlYnBhY2s6Ly8vLi9wcm9qZWN0cy9maWVsZC1jdXN0b20tZ3BzL3NyYy9tYWluL21haW4uY3NzIiwid2VicGFjazovLy8uL3Byb2plY3RzL3NoYXJlZC9maWVsZC1tYXNrLnNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vLy4vcHJvamVjdHMvZmllbGQtY3VzdG9tLWdwcy9zcmMvcHJldmlldy9wcmV2aWV3LnRzIiwid2VicGFjazovLy8uL3Byb2plY3RzL2ZpZWxkLWN1c3RvbS1ncHMvc3JjL3ByZXZpZXcvcHJldmlldy5odG1sIiwid2VicGFjazovLy8uL3Byb2plY3RzL2ZpZWxkLWN1c3RvbS1ncHMvc3JjL3ByZXZpZXcvcHJldmlldy5jc3MiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJFYXZDdXN0b21JbnB1dEZpZWxkIiwiX3N1cGVyIiwiX19leHRlbmRzIiwiSFRNTEVsZW1lbnQiLCJFYXZDdXN0b21JbnB1dEZpZWxkT2JzZXJ2YWJsZSIsImJ1aWxkVGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsInN0eWxlcyIsInBhcnNlTGF0TG5nIiwiSlNPTiIsInBhcnNlIiwicmVwbGFjZSIsInN0cmluZ2lmeUxhdExuZyIsImxhdExuZyIsInN0cmluZ2lmeSIsImRlZmF1bHRDb29yZGluYXRlcyIsImxhdCIsImxuZyIsIm1vZGVsc18xIiwiaGVscGVyc18xIiwiY29uc3RhbnRzXzEiLCJmaWVsZF9tYXNrX3NlcnZpY2VfMSIsIkZpZWxkQ3VzdG9tR3BzIiwiX3RoaXMiLCJ0aGlzIiwiY29uc29sZSIsImxvZyIsIm1hcEFwaVVybCIsImZpZWxkSW5pdGlhbGl6ZWQiLCJldmVudExpc3RlbmVycyIsImNvbm5lY3RlZENhbGxiYWNrIiwiaW5uZXJIVE1MIiwibGF0SW5wdXQiLCJxdWVyeVNlbGVjdG9yIiwibG5nSW5wdXQiLCJhZGRyZXNzTWFza0NvbnRhaW5lciIsImljb25TZWFyY2giLCJmb3JtYXR0ZWRBZGRyZXNzQ29udGFpbmVyIiwibWFwQ29udGFpbmVyIiwiYWxsSW5wdXROYW1lcyIsImV4cGVyaW1lbnRhbCIsImFsbElucHV0VHlwZU5hbWVzIiwibWFwIiwiaW5wdXRUeXBlIiwiaW5kZXhPZiIsImNvbm5lY3RvciIsImZpZWxkIiwic2V0dGluZ3MiLCJMYXRGaWVsZCIsImxhdEZpZWxkTmFtZSIsIkxvbmdGaWVsZCIsImxuZ0ZpZWxkTmFtZSIsImFkZHJlc3NNYXNrIiwiQWRkcmVzc01hc2siLCJhZGRyZXNzTWFza1NlcnZpY2UiLCJGaWVsZE1hc2tTZXJ2aWNlIiwiZm9ybUdyb3VwIiwiY29udHJvbHMiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJpbm5lclRleHQiLCJyZXNvbHZlIiwid2luZG93IiwiZ29vZ2xlIiwibWFwU2NyaXB0TG9hZGVkIiwic2NyaXB0IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwib25sb2FkIiwiYXBwZW5kQ2hpbGQiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsIm1hcmtlciIsIk1hcmtlciIsInBvc2l0aW9uIiwiZHJhZ2dhYmxlIiwiZ2VvY29kZXIiLCJHZW9jb2RlciIsImRhdGEiLCJ1cGRhdGVIdG1sIiwib25MYXRMbmdJbnB1dENoYW5nZUJvdW5kIiwib25MYXRMbmdJbnB1dENoYW5nZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJhdXRvU2VsZWN0Qm91bmQiLCJhdXRvU2VsZWN0IiwicHVzaCIsImVsZW1lbnQiLCJ0eXBlIiwibGlzdGVuZXIiLCJhZGRMaXN0ZW5lciIsIm9uTWFya2VyRHJhZ2VuZCIsInRvU3RyaW5nIiwic2V0Q2VudGVyIiwic2V0UG9zaXRpb24iLCJ1cGRhdGVGb3JtIiwidXBkYXRlIiwidXBkYXRlRmllbGQiLCJsZW5ndGgiLCJwYXJzZUZsb2F0IiwiYWRkcmVzcyIsImdlb2NvZGUiLCJyZXN1bHRzIiwic3RhdHVzIiwiR2VvY29kZXJTdGF0dXMiLCJPSyIsInJlc3VsdCIsImdlb21ldHJ5IiwibG9jYXRpb24iLCJhbGVydCIsImV2ZW50IiwiZGlzY29ubmVjdGVkQ2FsbGJhY2siLCJjbGVhckluc3RhbmNlTGlzdGVuZXJzIiwiZm9yRWFjaCIsImV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiRWF2RXhwZXJpbWVudGFsSW5wdXRGaWVsZCIsImN1c3RvbUVsZW1lbnRzIiwiZGVmaW5lIiwiRWxlbWVudEV2ZW50TGlzdGVuZXIiLCJtYXNrIiwibW9kZWwiLCJjaGFuZ2VFdmVudCIsIm92ZXJsb2FkUHJlQ2xlYW5WYWx1ZXMiLCJmaWVsZHMiLCJmaW5kRmllbGRzIiwidW53cmFwRmllbGQiLCJzdWJzY3JpcHRpb25zIiwiZmllbGRMaXN0IiwicHJlQ2xlYW4iLCJ3YXRjaEFsbEZpZWxkcyIsImUiLCJyZXBsYWNlVmFsdWUiLCJjbGVhbmVkIiwibWF0Y2hlcyIsIm1hdGNoIiwic3RhdGljTmFtZSIsIm9uQ2hhbmdlIiwibWF5YmVOZXciLCJ2YWxTdWIiLCJ2YWx1ZUNoYW5nZXMiLCJzdWJzY3JpYmUiLCJkZXN0cm95Iiwic3ViIiwidW5zdWJzY3JpYmUiLCJlYXZfY3VzdG9tX2lucHV0X2ZpZWxkXzEiLCJGaWVsZEN1c3RvbUdwc1ByZXZpZXciLCJsYXRDb250YWluZXIiLCJsbmdDb250YWluZXIiLCJvblZhbHVlQ2hhbmdlIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFB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QUNaRixLQUFLTyxVQUFZWixFQUFBZCxjQUFjQyxFQUFVQyxHQUN6Q2lCLEtBQUs2SCxhQUFlN0gsS0FBS1MsY0FBYyxrQkFDdkNULEtBQUs4SCxhQUFlOUgsS0FBS1MsY0FBYyxrQkFHbENULEtBQUtxQixVQUFVb0MsS0FBS2hHLE1BR3ZCdUMsS0FBSzBELFdBQVcvRCxFQUFBWCxZQUFZZ0IsS0FBS3FCLFVBQVVvQyxLQUFLaEcsUUFGaER1QyxLQUFLMEQsV0FBVzlELEVBQUFMLG9CQU1sQlMsS0FBS3FCLFVBQVVvQyxLQUFLc0UsY0FBYyxTQUFBdEssR0FDaEMsR0FBS0EsRUFFRSxDQUNMLElBQU00QixFQUFTTSxFQUFBWCxZQUFZdkIsR0FDM0JzQyxFQUFLMkQsV0FBV3JFLFFBSGhCVSxFQUFLMkQsV0FBVzlELEVBQUFMLHVCQVF0QnFJLEVBQUF4SixVQUFBc0YsV0FBQSxTQUFXckUsR0FDVFcsS0FBSzZILGFBQWF6RixVQUFZL0MsRUFBT0csSUFBTUgsRUFBT0csSUFBSThFLFdBQWEsR0FDbkV0RSxLQUFLOEgsYUFBYTFGLFVBQVkvQyxFQUFPSSxJQUFNSixFQUFPSSxJQUFJNkUsV0FBYSxJQUdyRXNELEVBQUF4SixVQUFBcUgscUJBQUEsV0FDRXhGLFFBQVFDLElBQUksc0RBRWhCMEgsRUF6Q0EsQ0FBb0NELEVBQUFuSixxQkEyQ3BDdUgsZUFBZUMsT0FBTywyQkFBNEI0QixrQkNqRGxEckwsRUFBQUQsUUFBQSxrR0NBQUMsRUFBQUQsUUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiaW1wb3J0IHsgQ29ubmVjdG9yLCBDb25uZWN0b3JPYnNlcnZhYmxlIH0gZnJvbSAnLi9jb25uZWN0b3InO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVhdkN1c3RvbUlucHV0RmllbGQ8VD4gZXh0ZW5kcyBIVE1MRWxlbWVudCB7XHJcbiAgY29ubmVjdG9yOiBDb25uZWN0b3I8VD47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFYXZDdXN0b21JbnB1dEZpZWxkT2JzZXJ2YWJsZTxUPiBleHRlbmRzIEVhdkN1c3RvbUlucHV0RmllbGQ8VD4ge1xyXG4gIGNvbm5lY3RvcjogQ29ubmVjdG9yT2JzZXJ2YWJsZTxUPjtcclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gYnVpbGRUZW1wbGF0ZSh0ZW1wbGF0ZTogc3RyaW5nLCBzdHlsZXM6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGAke3RlbXBsYXRlfTxzdHlsZT5cXG4ke3N0eWxlc31cXG48L3N0eWxlPmA7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxhdExuZyh2YWx1ZTogc3RyaW5nKTogZ29vZ2xlLm1hcHMuTGF0TG5nTGl0ZXJhbCB7XHJcbiAgY29uc3QgbGF0TG5nOiBnb29nbGUubWFwcy5MYXRMbmdMaXRlcmFsID0gSlNPTi5wYXJzZSh2YWx1ZS5yZXBsYWNlKCdsYXRpdHVkZScsICdsYXQnKS5yZXBsYWNlKCdsb25naXR1ZGUnLCAnbG5nJykpO1xyXG4gIHJldHVybiBsYXRMbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdpZnlMYXRMbmcobGF0TG5nOiBnb29nbGUubWFwcy5MYXRMbmdMaXRlcmFsKTogc3RyaW5nIHtcclxuICBjb25zdCB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5KGxhdExuZykucmVwbGFjZSgnbGF0JywgJ2xhdGl0dWRlJykucmVwbGFjZSgnbG5nJywgJ2xvbmdpdHVkZScpO1xyXG4gIHJldHVybiB2YWx1ZTtcclxufVxyXG4iLCJpbXBvcnQgeyB9IGZyb20gJ2dvb2dsZS1tYXBzJztcclxuXHJcbmV4cG9ydCBjb25zdCBkZWZhdWx0Q29vcmRpbmF0ZXM6IGdvb2dsZS5tYXBzLkxhdExuZ0xpdGVyYWwgPSB7XHJcbiAgbGF0OiA0Ny4xNzQ2NTk4OTk5OTk5OSxcclxuICBsbmc6IDkuNDY5MTQyNDk5OTk5OTc1LFxyXG59O1xyXG4iLCJpbXBvcnQgeyB9IGZyb20gJ2dvb2dsZS1tYXBzJztcclxuXHJcbmltcG9ydCB7IEVhdkV4cGVyaW1lbnRhbElucHV0RmllbGQsIEVsZW1lbnRFdmVudExpc3RlbmVyIH0gZnJvbSAnLi4vc2hhcmVkL21vZGVscyc7XHJcbmltcG9ydCB7IGJ1aWxkVGVtcGxhdGUsIHBhcnNlTGF0TG5nLCBzdHJpbmdpZnlMYXRMbmcgfSBmcm9tICcuLi9zaGFyZWQvaGVscGVycyc7XHJcbmltcG9ydCB7IGRlZmF1bHRDb29yZGluYXRlcyB9IGZyb20gJy4uL3NoYXJlZC9jb25zdGFudHMnO1xyXG5pbXBvcnQgKiBhcyB0ZW1wbGF0ZSBmcm9tICcuL21haW4uaHRtbCc7XHJcbmltcG9ydCAqIGFzIHN0eWxlcyBmcm9tICcuL21haW4uY3NzJztcclxuaW1wb3J0IHsgRmllbGRNYXNrU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9maWVsZC1tYXNrLnNlcnZpY2UnO1xyXG5cclxuY2xhc3MgRmllbGRDdXN0b21HcHMgZXh0ZW5kcyBFYXZFeHBlcmltZW50YWxJbnB1dEZpZWxkPHN0cmluZz4ge1xyXG4gIGV2ZW50TGlzdGVuZXJzOiBFbGVtZW50RXZlbnRMaXN0ZW5lcltdO1xyXG4gIGZpZWxkSW5pdGlhbGl6ZWQ6IGJvb2xlYW47XHJcbiAgYWRkcmVzc01hc2tTZXJ2aWNlOiBGaWVsZE1hc2tTZXJ2aWNlO1xyXG4gIGdlb2NvZGVyOiBnb29nbGUubWFwcy5HZW9jb2RlcjtcclxuICBpY29uU2VhcmNoOiBIVE1MQW5jaG9yRWxlbWVudDtcclxuICBsYXRGaWVsZE5hbWU6IHN0cmluZztcclxuICBsYXRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICBsbmdGaWVsZE5hbWU6IHN0cmluZztcclxuICBsbmdJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICBtYXA6IGdvb2dsZS5tYXBzLk1hcDtcclxuICBtYXBBcGlVcmw6IHN0cmluZztcclxuICBtYXBDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gIG1hcmtlcjogZ29vZ2xlLm1hcHMuTWFya2VyO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHMgY29uc3RydWN0b3IgY2FsbGVkJyk7XHJcbiAgICBjb25zdCBtYXBBcGlLZXkgPSAnQUl6YVN5RFBobk5LcEVnOEZtWThub29FN1p3bnVlNlN1c3hFbkhFJztcclxuICAgIHRoaXMubWFwQXBpVXJsID0gYGh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9qcz9rZXk9JHttYXBBcGlLZXl9YDtcclxuICAgIHRoaXMuZmllbGRJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHMgY29ubmVjdGVkQ2FsbGJhY2sgY2FsbGVkJyk7XHJcbiAgICAvLyBzcG0gcHJldmVudHMgY29ubmVjdGVkQ2FsbGJhY2sgZnJvbSBiZWluZyBjYWxsZWQgbW9yZSB0aGFuIG9uY2UuIERvbid0IGtub3cgaWYgaXQncyBuZWNlc3NhcnlcclxuICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2N1c3RvbS1lbGVtZW50cy5odG1sI2N1c3RvbS1lbGVtZW50LWNvbmZvcm1hbmNlXHJcbiAgICBpZiAodGhpcy5maWVsZEluaXRpYWxpemVkKSB7IHJldHVybjsgfVxyXG4gICAgdGhpcy5maWVsZEluaXRpYWxpemVkID0gdHJ1ZTtcclxuXHJcbiAgICB0aGlzLmlubmVySFRNTCA9IGJ1aWxkVGVtcGxhdGUodGVtcGxhdGUsIHN0eWxlcyk7XHJcbiAgICB0aGlzLmxhdElucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcjbGF0Jyk7XHJcbiAgICB0aGlzLmxuZ0lucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcjbG5nJyk7XHJcbiAgICBjb25zdCBhZGRyZXNzTWFza0NvbnRhaW5lciA9IDxIVE1MRGl2RWxlbWVudD50aGlzLnF1ZXJ5U2VsZWN0b3IoJyNhZGRyZXNzLW1hc2stY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLmljb25TZWFyY2ggPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJyNpY29uLXNlYXJjaCcpO1xyXG4gICAgY29uc3QgZm9ybWF0dGVkQWRkcmVzc0NvbnRhaW5lciA9IDxIVE1MU3BhbkVsZW1lbnQ+dGhpcy5xdWVyeVNlbGVjdG9yKCcjZm9ybWF0dGVkLWFkZHJlc3MtY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLm1hcENvbnRhaW5lciA9IHRoaXMucXVlcnlTZWxlY3RvcignI21hcCcpO1xyXG5cclxuICAgIGNvbnN0IGFsbElucHV0TmFtZXMgPSB0aGlzLmV4cGVyaW1lbnRhbC5hbGxJbnB1dFR5cGVOYW1lcy5tYXAoaW5wdXRUeXBlID0+IGlucHV0VHlwZS5uYW1lKTtcclxuICAgIGlmIChhbGxJbnB1dE5hbWVzLmluZGV4T2YodGhpcy5jb25uZWN0b3IuZmllbGQuc2V0dGluZ3MuTGF0RmllbGQpICE9PSAtMSkge1xyXG4gICAgICB0aGlzLmxhdEZpZWxkTmFtZSA9IHRoaXMuY29ubmVjdG9yLmZpZWxkLnNldHRpbmdzLkxhdEZpZWxkO1xyXG4gICAgfVxyXG4gICAgaWYgKGFsbElucHV0TmFtZXMuaW5kZXhPZih0aGlzLmNvbm5lY3Rvci5maWVsZC5zZXR0aW5ncy5Mb25nRmllbGQpICE9PSAtMSkge1xyXG4gICAgICB0aGlzLmxuZ0ZpZWxkTmFtZSA9IHRoaXMuY29ubmVjdG9yLmZpZWxkLnNldHRpbmdzLkxvbmdGaWVsZDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhZGRyZXNzTWFzayA9IHRoaXMuY29ubmVjdG9yLmZpZWxkLnNldHRpbmdzLkFkZHJlc3NNYXNrIHx8IHRoaXMuY29ubmVjdG9yLmZpZWxkLnNldHRpbmdzWydBZGRyZXNzIE1hc2snXTtcclxuICAgIHRoaXMuYWRkcmVzc01hc2tTZXJ2aWNlID0gbmV3IEZpZWxkTWFza1NlcnZpY2UoYWRkcmVzc01hc2ssIHRoaXMuZXhwZXJpbWVudGFsLmZvcm1Hcm91cC5jb250cm9scywgbnVsbCwgbnVsbCk7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHMgYWRkcmVzc01hc2s6JywgYWRkcmVzc01hc2spO1xyXG4gICAgaWYgKGFkZHJlc3NNYXNrKSB7XHJcbiAgICAgIGFkZHJlc3NNYXNrQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xyXG4gICAgICBmb3JtYXR0ZWRBZGRyZXNzQ29udGFpbmVyLmlubmVyVGV4dCA9IHRoaXMuYWRkcmVzc01hc2tTZXJ2aWNlLnJlc29sdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtYXBTY3JpcHRMb2FkZWQgPSAhISh3aW5kb3cgYXMgYW55KS5nb29nbGU7XHJcbiAgICBpZiAobWFwU2NyaXB0TG9hZGVkKSB7XHJcbiAgICAgIHRoaXMubWFwU2NyaXB0TG9hZGVkKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgc2NyaXB0LnNyYyA9IHRoaXMubWFwQXBpVXJsO1xyXG4gICAgICBzY3JpcHQub25sb2FkID0gdGhpcy5tYXBTY3JpcHRMb2FkZWQuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5hcHBlbmRDaGlsZChzY3JpcHQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBtYXBTY3JpcHRMb2FkZWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHMgbWFwU2NyaXB0TG9hZGVkIGNhbGxlZCcpO1xyXG4gICAgdGhpcy5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKHRoaXMubWFwQ29udGFpbmVyLCB7IHpvb206IDE1LCBjZW50ZXI6IGRlZmF1bHRDb29yZGluYXRlcyB9KTtcclxuICAgIHRoaXMubWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7IHBvc2l0aW9uOiBkZWZhdWx0Q29vcmRpbmF0ZXMsIG1hcDogdGhpcy5tYXAsIGRyYWdnYWJsZTogdHJ1ZSB9KTtcclxuICAgIHRoaXMuZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcclxuXHJcbiAgICAvLyBzZXQgaW5pdGlhbCB2YWx1ZXNcclxuICAgIGlmICghdGhpcy5jb25uZWN0b3IuZGF0YS52YWx1ZSkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUh0bWwoZGVmYXVsdENvb3JkaW5hdGVzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudXBkYXRlSHRtbChwYXJzZUxhdExuZyh0aGlzLmNvbm5lY3Rvci5kYXRhLnZhbHVlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbGlzdGVuIHRvIGlucHV0cywgaWNvblNlYXJjaCBhbmQgbWFya2VyLiBVcGRhdGUgaW5wdXRzLCBtYXAsIG1hcmtlciBhbmQgZm9ybVxyXG4gICAgY29uc3Qgb25MYXRMbmdJbnB1dENoYW5nZUJvdW5kID0gdGhpcy5vbkxhdExuZ0lucHV0Q2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmxhdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uTGF0TG5nSW5wdXRDaGFuZ2VCb3VuZCk7XHJcbiAgICB0aGlzLmxuZ0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uTGF0TG5nSW5wdXRDaGFuZ2VCb3VuZCk7XHJcblxyXG4gICAgY29uc3QgYXV0b1NlbGVjdEJvdW5kID0gdGhpcy5hdXRvU2VsZWN0LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmljb25TZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhdXRvU2VsZWN0Qm91bmQpO1xyXG5cclxuICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChcclxuICAgICAgeyBlbGVtZW50OiB0aGlzLmxhdElucHV0LCB0eXBlOiAnY2hhbmdlJywgbGlzdGVuZXI6IG9uTGF0TG5nSW5wdXRDaGFuZ2VCb3VuZCB9LFxyXG4gICAgICB7IGVsZW1lbnQ6IHRoaXMubG5nSW5wdXQsIHR5cGU6ICdjaGFuZ2UnLCBsaXN0ZW5lcjogb25MYXRMbmdJbnB1dENoYW5nZUJvdW5kIH0sXHJcbiAgICAgIHsgZWxlbWVudDogdGhpcy5pY29uU2VhcmNoLCB0eXBlOiAnY2xpY2snLCBsaXN0ZW5lcjogYXV0b1NlbGVjdEJvdW5kIH0sXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMubWFya2VyLmFkZExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5vbk1hcmtlckRyYWdlbmQuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUh0bWwobGF0TG5nOiBnb29nbGUubWFwcy5MYXRMbmdMaXRlcmFsKSB7XHJcbiAgICB0aGlzLmxhdElucHV0LnZhbHVlID0gbGF0TG5nLmxhdCA/IGxhdExuZy5sYXQudG9TdHJpbmcoKSA6ICcnO1xyXG4gICAgdGhpcy5sbmdJbnB1dC52YWx1ZSA9IGxhdExuZy5sbmcgPyBsYXRMbmcubG5nLnRvU3RyaW5nKCkgOiAnJztcclxuICAgIHRoaXMubWFwLnNldENlbnRlcihsYXRMbmcpO1xyXG4gICAgdGhpcy5tYXJrZXIuc2V0UG9zaXRpb24obGF0TG5nKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlRm9ybShsYXRMbmc6IGdvb2dsZS5tYXBzLkxhdExuZ0xpdGVyYWwpIHtcclxuICAgIHRoaXMuY29ubmVjdG9yLmRhdGEudXBkYXRlKHN0cmluZ2lmeUxhdExuZyhsYXRMbmcpKTtcclxuICAgIGlmICh0aGlzLmxhdEZpZWxkTmFtZSkge1xyXG4gICAgICB0aGlzLmV4cGVyaW1lbnRhbC51cGRhdGVGaWVsZCh0aGlzLmxhdEZpZWxkTmFtZSwgbGF0TG5nLmxhdCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5sbmdGaWVsZE5hbWUpIHtcclxuICAgICAgdGhpcy5leHBlcmltZW50YWwudXBkYXRlRmllbGQodGhpcy5sbmdGaWVsZE5hbWUsIGxhdExuZy5sbmcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbkxhdExuZ0lucHV0Q2hhbmdlKCkge1xyXG4gICAgY29uc29sZS5sb2coJ0ZpZWxkQ3VzdG9tR3BzIGlucHV0IGNoYW5nZWQnKTtcclxuICAgIGNvbnN0IGxhdExuZzogZ29vZ2xlLm1hcHMuTGF0TG5nTGl0ZXJhbCA9IHtcclxuICAgICAgbGF0OiB0aGlzLmxhdElucHV0LnZhbHVlLmxlbmd0aCA+IDAgPyBwYXJzZUZsb2F0KHRoaXMubGF0SW5wdXQudmFsdWUpIDogbnVsbCxcclxuICAgICAgbG5nOiB0aGlzLmxuZ0lucHV0LnZhbHVlLmxlbmd0aCA+IDAgPyBwYXJzZUZsb2F0KHRoaXMubG5nSW5wdXQudmFsdWUpIDogbnVsbCxcclxuICAgIH07XHJcbiAgICB0aGlzLnVwZGF0ZUh0bWwobGF0TG5nKTtcclxuICAgIHRoaXMudXBkYXRlRm9ybShsYXRMbmcpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhdXRvU2VsZWN0KCkge1xyXG4gICAgY29uc29sZS5sb2coJ0ZpZWxkQ3VzdG9tR3BzIGdlb2NvZGVyIGNhbGxlZCcpO1xyXG4gICAgY29uc3QgYWRkcmVzcyA9IHRoaXMuYWRkcmVzc01hc2tTZXJ2aWNlLnJlc29sdmUoKTtcclxuICAgIHRoaXMuZ2VvY29kZXIuZ2VvY29kZSh7XHJcbiAgICAgIGFkZHJlc3M6IGFkZHJlc3NcclxuICAgIH0sIChyZXN1bHRzLCBzdGF0dXMpID0+IHtcclxuICAgICAgaWYgKHN0YXR1cyA9PT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uO1xyXG4gICAgICAgIGNvbnN0IGxhdExuZzogZ29vZ2xlLm1hcHMuTGF0TG5nTGl0ZXJhbCA9IHtcclxuICAgICAgICAgIGxhdDogcmVzdWx0LmxhdCgpLFxyXG4gICAgICAgICAgbG5nOiByZXN1bHQubG5nKCksXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUh0bWwobGF0TG5nKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUZvcm0obGF0TG5nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhbGVydChgQ291bGQgbm90IGxvY2F0ZSBhZGRyZXNzOiAke2FkZHJlc3N9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvbk1hcmtlckRyYWdlbmQoZXZlbnQ6IGdvb2dsZS5tYXBzLk1vdXNlRXZlbnQpIHtcclxuICAgIGNvbnNvbGUubG9nKCdGaWVsZEN1c3RvbUdwcyBtYXJrZXIgY2hhbmdlZCcpO1xyXG4gICAgY29uc3QgbGF0TG5nOiBnb29nbGUubWFwcy5MYXRMbmdMaXRlcmFsID0ge1xyXG4gICAgICBsYXQ6IGV2ZW50LmxhdExuZy5sYXQoKSxcclxuICAgICAgbG5nOiBldmVudC5sYXRMbmcubG5nKCksXHJcbiAgICB9O1xyXG4gICAgdGhpcy51cGRhdGVIdG1sKGxhdExuZyk7XHJcbiAgICB0aGlzLnVwZGF0ZUZvcm0obGF0TG5nKTtcclxuICB9XHJcblxyXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgY29uc29sZS5sb2coJ0ZpZWxkQ3VzdG9tR3BzIGRpc2Nvbm5lY3RlZENhbGxiYWNrIGNhbGxlZCcpO1xyXG4gICAgaWYgKCEhKHdpbmRvdyBhcyBhbnkpLmdvb2dsZSkge1xyXG4gICAgICBnb29nbGUubWFwcy5ldmVudC5jbGVhckluc3RhbmNlTGlzdGVuZXJzKHRoaXMubWFya2VyKTtcclxuICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuY2xlYXJJbnN0YW5jZUxpc3RlbmVycyh0aGlzLm1hcCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKGV2ZW50TGlzdGVuZXIgPT4ge1xyXG4gICAgICBjb25zdCBlbGVtZW50ID0gZXZlbnRMaXN0ZW5lci5lbGVtZW50O1xyXG4gICAgICBjb25zdCB0eXBlID0gZXZlbnRMaXN0ZW5lci50eXBlO1xyXG4gICAgICBjb25zdCBsaXN0ZW5lciA9IGV2ZW50TGlzdGVuZXIubGlzdGVuZXI7XHJcbiAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcik7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmN1c3RvbUVsZW1lbnRzLmRlZmluZSgnZmllbGQtY3VzdG9tLWdwcycsIEZpZWxkQ3VzdG9tR3BzKTtcclxuIiwiaW1wb3J0IHsgRWF2Q3VzdG9tSW5wdXRGaWVsZCB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9lYXYtY3VzdG9tLWlucHV0LWZpZWxkJztcclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxyXG5pbXBvcnQgeyBFeHBlcmltZW50YWxQcm9wcyB9IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9hcHAvZWF2LW1hdGVyaWFsLWNvbnRyb2xzL2lucHV0LXR5cGVzL2N1c3RvbS9leHRlcm5hbC13ZWJjb21wb25lbnQtcHJvcGVydGllcy9leHRlcm5hbC13ZWJjb21wb25lbnQtcHJvcGVydGllcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgRWF2RXhwZXJpbWVudGFsSW5wdXRGaWVsZDxUPiBleHRlbmRzIEVhdkN1c3RvbUlucHV0RmllbGQ8VD4ge1xyXG4gIGV4cGVyaW1lbnRhbDogRXhwZXJpbWVudGFsUHJvcHM7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFbGVtZW50RXZlbnRMaXN0ZW5lciB7XHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcbiAgdHlwZTogc3RyaW5nO1xyXG4gIGxpc3RlbmVyOiBFdmVudExpc3RlbmVyT3JFdmVudExpc3RlbmVyT2JqZWN0O1xyXG59XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gXCI8ZGl2IGNsYXNzPVxcXCJjdXN0b20tZ3BzLWNvbnRhaW5lclxcXCI+XFxyXFxuICA8ZGl2IGNsYXNzPVxcXCJtYXAtaW5mb1xcXCI+XFxyXFxuICAgIDxkaXYgY2xhc3M9XFxcImlucHV0LWNvbXBvbmVudFxcXCI+XFxyXFxuICAgICAgPGxhYmVsIGZvcj1cXFwibGF0XFxcIj5MYXQ6PC9sYWJlbD5cXHJcXG4gICAgICA8aW5wdXQgaWQ9XFxcImxhdFxcXCIgdHlwZT1cXFwibnVtYmVyXFxcIiBzdGVwPVxcXCIwLjAwMVxcXCIgLz5cXHJcXG4gICAgPC9kaXY+XFxyXFxuICAgICZuYnNwO1xcclxcbiAgICA8ZGl2IGNsYXNzPVxcXCJpbnB1dC1jb21wb25lbnRcXFwiPlxcclxcbiAgICAgIDxsYWJlbCBmb3I9XFxcImxuZ1xcXCI+TG5nOjwvbGFiZWw+XFxyXFxuICAgICAgPGlucHV0IGlkPVxcXCJsbmdcXFwiIHR5cGU9XFxcIm51bWJlclxcXCIgc3RlcD1cXFwiMC4wMDFcXFwiIC8+XFxyXFxuICAgIDwvZGl2PlxcclxcbiAgPC9kaXY+XFxyXFxuXFxyXFxuICA8ZGl2IGlkPVxcXCJhZGRyZXNzLW1hc2stY29udGFpbmVyXFxcIiBjbGFzcz1cXFwibWFwLWluZm8gaGlkZGVuXFxcIj5cXHJcXG4gICAgPGEgaWQ9XFxcImljb24tc2VhcmNoXFxcIiBjbGFzcz1cXFwiYnRuXFxcIj5cXHJcXG4gICAgICA8c3BhbiBjbGFzcz1cXFwiZWF2LWljb24tc2VhcmNoXFxcIiBpY29uPVxcXCJzZWFyY2hcXFwiPjwvc3Bhbj5cXHJcXG4gICAgPC9hPlxcclxcbiAgICA8c3BhbiBpZD1cXFwiZm9ybWF0dGVkLWFkZHJlc3MtY29udGFpbmVyXFxcIj48L3NwYW4+XFxyXFxuICA8L2Rpdj5cXHJcXG5cXHJcXG4gIDxkaXYgaWQ9XFxcIm1hcFxcXCIgY2xhc3M9XFxcIm1hcC1pbmZvX19tYXBcXFwiPjwvZGl2PlxcclxcbjwvZGl2PlxcclxcblwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIi5jdXN0b20tZ3BzLWNvbnRhaW5lciB7XFxyXFxuICBkaXNwbGF5OiBmbGV4O1xcclxcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXHJcXG4gIGhlaWdodDogMTAwJTtcXHJcXG59XFxyXFxuXFxyXFxuLm1hcC1pbmZvIHtcXHJcXG4gIGZsZXg6IDAgMCAzMnB4O1xcclxcbiAgZGlzcGxheTogZmxleDtcXHJcXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxyXFxuICBwYWRkaW5nOiA0cHg7XFxyXFxuICBwYWRkaW5nLWxlZnQ6IDEwcHg7XFxyXFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2UxZTFlMTtcXHJcXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xcclxcbn1cXHJcXG5cXHJcXG4ubWFwLWluZm8gbGFiZWwsXFxyXFxuLm1hcC1pbmZvICNpY29uLXNlYXJjaCB7XFxyXFxuICBtYXJnaW4tcmlnaHQ6IDhweDtcXHJcXG4gIGRpc3BsYXk6IGZsZXg7XFxyXFxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXHJcXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxyXFxuICBmb250LXNpemU6IDEycHg7XFxyXFxuICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlO1xcclxcbiAgcGFkZGluZzogNHB4O1xcclxcbn1cXHJcXG5cXHJcXG4ubWFwLWluZm8gaW5wdXQge1xcclxcbiAgbWFyZ2luLXJpZ2h0OiA4cHg7XFxyXFxuICBwYWRkaW5nOiA0cHggMTZweDtcXHJcXG4gIGJvcmRlcjogbm9uZTtcXHJcXG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xcclxcbiAgb3V0bGluZTogbm9uZSAhaW1wb3J0YW50O1xcclxcbn1cXHJcXG5cXHJcXG4ubWFwLWluZm9fX21hcCB7XFxyXFxuICBmbGV4OiAxIDEgYXV0bztcXHJcXG4gIHdpZHRoOiAxMDAlO1xcclxcbiAgZGlzcGxheTogYmxvY2s7XFxyXFxufVxcclxcblxcclxcbi5oaWRkZW4ge1xcclxcbiAgZGlzcGxheTogbm9uZTtcXHJcXG59XFxyXFxuXFxyXFxuLmJ0biB7XFxyXFxuICBib3JkZXI6IDFweCBzb2xpZCBzaWx2ZXI7XFxyXFxuICBib3JkZXItcmFkaXVzOiA0cHg7XFxyXFxufVxcclxcbi5idG46aG92ZXIge1xcclxcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg2OSwgNzksIDk5LCAwLjA4KTtcXHJcXG4gIGN1cnNvcjogcG9pbnRlcjtcXHJcXG59XFxyXFxuXFxyXFxuLmlucHV0LWNvbXBvbmVudCB7XFxyXFxuICBkaXNwbGF5OiBmbGV4O1xcclxcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg2OSwgNzksIDk5LCAwLjA4KTtcXHJcXG4gIHBhZGRpbmc6IDRweDtcXHJcXG4gIGJvcmRlci1yYWRpdXM6IDRweCA0cHggMCAwO1xcclxcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHNpbHZlcjtcXHJcXG4gIG1hcmdpbjogOHB4IDA7XFxyXFxufVxcclxcbi5pbnB1dC1jb21wb25lbnQ6aG92ZXIge1xcclxcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICMwMDg3ZjQ7XFxyXFxufVxcclxcblwiIiwiaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYSBuZXcgRmllbGRNYXNrU2VydmljZSBpbnN0YW5jZSBhbmQgYWNjZXNzIHJlc3VsdCB3aXRoIHJlc29sdmVcclxuICogQGV4YW1wbGVcclxuICogY29uc3QgbWFzayA9IG5ldyBGaWVsZE1hc2tTZXJ2aWNlKFwiW0ZpcnN0TmFtZV1cIiwgZm9ybUdyb3VwLmNvbnRyb2xzKTtcclxuICogY29uc3QgbWFza1ZhbHVlID0gbWFzay5yZXNvbHZlKCk7XHJcbiAqXHJcbiAqIEBwYXJhbSBtYXNrIGEgc3RyaW5nIGxpa2UgXCJbRmlyc3ROYW1lXSBbTGFzdE5hbWVdXCJcclxuICogQHBhcmFtIG1vZGVsIHVzdWFsbHkgRm9ybUdyb3VwIGNvbnRyb2xzLCBwYXNzZWQgaW50byBoZXJlXHJcbiAqIEBwYXJhbSBvdmVybG9hZFByZUNsZWFuVmFsdWVzIGEgZnVuY3Rpb24gd2hpY2ggd2lsbCBcInNjcnViXCIgdGhlIGZvdW5kIGZpZWxkLXZhbHVlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEZpZWxkTWFza1NlcnZpY2Uge1xyXG4gIHByaXZhdGUgbWFzazogc3RyaW5nO1xyXG4gIHByaXZhdGUgbW9kZWw6IHsgW2tleTogc3RyaW5nXTogQWJzdHJhY3RDb250cm9sOyB9O1xyXG4gIHByaXZhdGUgZmllbGRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIHByaXZhdGUgdmFsdWU6IHN0cmluZztcclxuICBwcml2YXRlIGZpbmRGaWVsZHMgPSAvXFxbLio/XFxdL2lnO1xyXG4gIHByaXZhdGUgdW53cmFwRmllbGQgPSAvW1xcW1xcXV0vaWc7XHJcbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIG1hc2s6IHN0cmluZyxcclxuICAgIG1vZGVsOiB7IFtrZXk6IHN0cmluZ106IEFic3RyYWN0Q29udHJvbDsgfSxcclxuICAgIHByaXZhdGUgY2hhbmdlRXZlbnQ6IChuZXdWYWx1ZTogc3RyaW5nKSA9PiBhbnksXHJcbiAgICBvdmVybG9hZFByZUNsZWFuVmFsdWVzOiAoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHN0cmluZyxcclxuICApIHtcclxuICAgIHRoaXMubWFzayA9IG1hc2s7XHJcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XHJcbiAgICB0aGlzLmZpZWxkcyA9IHRoaXMuZmllbGRMaXN0KCk7XHJcblxyXG4gICAgaWYgKG92ZXJsb2FkUHJlQ2xlYW5WYWx1ZXMpIHtcclxuICAgICAgdGhpcy5wcmVDbGVhbiA9IG92ZXJsb2FkUHJlQ2xlYW5WYWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYmluZCBhdXRvLXdhdGNoIG9ubHkgaWYgbmVlZGVkLi4uXHJcbiAgICBpZiAobW9kZWwgJiYgY2hhbmdlRXZlbnQpIHtcclxuICAgICAgdGhpcy53YXRjaEFsbEZpZWxkcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqIFJlc29sdmVzIGEgbWFzayB0byB0aGUgZmluYWwgdmFsdWUgKi9cclxuICByZXNvbHZlKCk6IHN0cmluZyB7XHJcbiAgICBsZXQgdmFsdWUgPSB0aGlzLm1hc2s7XHJcbiAgICB0aGlzLmZpZWxkcy5mb3JFYWNoKChlLCBpKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlcGxhY2VWYWx1ZSA9IHRoaXMubW9kZWwuaGFzT3duUHJvcGVydHkoZSkgJiYgdGhpcy5tb2RlbFtlXSAmJiB0aGlzLm1vZGVsW2VdLnZhbHVlID8gdGhpcy5tb2RlbFtlXS52YWx1ZSA6ICcnO1xyXG4gICAgICBjb25zdCBjbGVhbmVkID0gdGhpcy5wcmVDbGVhbihlLCByZXBsYWNlVmFsdWUpO1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoJ1snICsgZSArICddJywgY2xlYW5lZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKiogUmV0cmlldmVzIGEgbGlzdCBvZiBhbGwgZmllbGRzIHVzZWQgaW4gdGhlIG1hc2sgKi9cclxuICBmaWVsZExpc3QoKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgcmVzdWx0OiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgaWYgKCF0aGlzLm1hc2spIHsgcmV0dXJuIHJlc3VsdDsgfVxyXG4gICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMubWFzay5tYXRjaCh0aGlzLmZpbmRGaWVsZHMpO1xyXG4gICAgaWYgKG1hdGNoZXMpIHtcclxuICAgICAgbWF0Y2hlcy5mb3JFYWNoKChlLCBpKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RhdGljTmFtZSA9IGUucmVwbGFjZSh0aGlzLnVud3JhcEZpZWxkLCAnJyk7XHJcbiAgICAgICAgcmVzdWx0LnB1c2goc3RhdGljTmFtZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHsgLy8gVE9ETzogYXNrIGlzIHRoaXMgZ29vZFxyXG4gICAgICByZXN1bHQucHVzaCh0aGlzLm1hc2spO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKiBEZWZhdWx0IHByZUNsZWFuIGZ1bmN0aW9uICovXHJcbiAgcHJpdmF0ZSBwcmVDbGVhbihrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKiogQ2hhbmdlLWV2ZW50IC0gd2lsbCBvbmx5IGZpcmUgaWYgaXQgcmVhbGx5IGNoYW5nZXMgKi9cclxuICBwcml2YXRlIG9uQ2hhbmdlKCkge1xyXG4gICAgY29uc29sZS5sb2coJ1N0cmluZ1RlbXBsYXRlUGlja2VyQ29tcG9uZW50IG9uQ2hhbmdlIGNhbGxlZCcpO1xyXG4gICAgY29uc3QgbWF5YmVOZXcgPSB0aGlzLnJlc29sdmUoKTtcclxuICAgIGlmICh0aGlzLnZhbHVlICE9PSBtYXliZU5ldykge1xyXG4gICAgICB0aGlzLmNoYW5nZUV2ZW50KG1heWJlTmV3KTtcclxuICAgIH1cclxuICAgIHRoaXMudmFsdWUgPSBtYXliZU5ldztcclxuICB9XHJcblxyXG4gIC8qKiBBZGQgd2F0Y2hlciBhbmQgZXhlY3V0ZSBvbkNoYW5nZSAqL1xyXG4gIHByaXZhdGUgd2F0Y2hBbGxGaWVsZHMoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnU3RyaW5nVGVtcGxhdGVQaWNrZXJDb21wb25lbnQgd2F0Y2hBbGxGaWVsZHMgY2FsbGVkJyk7XHJcbiAgICAvLyBhZGQgYSB3YXRjaCBmb3IgZWFjaCBmaWVsZCBpbiB0aGUgZmllbGQtbWFza1xyXG4gICAgdGhpcy5maWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICAgIGNvbnN0IHZhbFN1YiA9IHRoaXMubW9kZWxbZmllbGRdLnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUodmFsdWUgPT4gdGhpcy5vbkNoYW5nZSgpKTtcclxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godmFsU3ViKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKHN1YiA9PiBzdWIudW5zdWJzY3JpYmUoKSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEVhdkN1c3RvbUlucHV0RmllbGQgfSBmcm9tICcuLi8uLi8uLi9zaGFyZWQvZWF2LWN1c3RvbS1pbnB1dC1maWVsZCc7XHJcbmltcG9ydCB7IGJ1aWxkVGVtcGxhdGUsIHBhcnNlTGF0TG5nIH0gZnJvbSAnLi4vc2hhcmVkL2hlbHBlcnMnO1xyXG5pbXBvcnQgeyBkZWZhdWx0Q29vcmRpbmF0ZXMgfSBmcm9tICcuLi9zaGFyZWQvY29uc3RhbnRzJztcclxuaW1wb3J0ICogYXMgdGVtcGxhdGUgZnJvbSAnLi9wcmV2aWV3Lmh0bWwnO1xyXG5pbXBvcnQgKiBhcyBzdHlsZXMgZnJvbSAnLi9wcmV2aWV3LmNzcyc7XHJcblxyXG5jbGFzcyBGaWVsZEN1c3RvbUdwc1ByZXZpZXcgZXh0ZW5kcyBFYXZDdXN0b21JbnB1dEZpZWxkPHN0cmluZz4ge1xyXG4gIGxhdENvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xyXG4gIGxuZ0NvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHNQcmV2aWV3IGNvbnN0cnVjdG9yIGNhbGxlZCcpO1xyXG4gIH1cclxuXHJcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBjb25zb2xlLmxvZygnRmllbGRDdXN0b21HcHNQcmV2aWV3IGNvbm5lY3RlZENhbGxiYWNrIGNhbGxlZCcpO1xyXG4gICAgdGhpcy5pbm5lckhUTUwgPSBidWlsZFRlbXBsYXRlKHRlbXBsYXRlLCBzdHlsZXMpO1xyXG4gICAgdGhpcy5sYXRDb250YWluZXIgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJyNsYXQtY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLmxuZ0NvbnRhaW5lciA9IHRoaXMucXVlcnlTZWxlY3RvcignI2xuZy1jb250YWluZXInKTtcclxuXHJcbiAgICAvLyBzZXQgaW5pdGlhbCB2YWx1ZVxyXG4gICAgaWYgKCF0aGlzLmNvbm5lY3Rvci5kYXRhLnZhbHVlKSB7XHJcbiAgICAgIHRoaXMudXBkYXRlSHRtbChkZWZhdWx0Q29vcmRpbmF0ZXMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy51cGRhdGVIdG1sKHBhcnNlTGF0TG5nKHRoaXMuY29ubmVjdG9yLmRhdGEudmFsdWUpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB1cGRhdGUgb24gdmFsdWUgY2hhbmdlXHJcbiAgICB0aGlzLmNvbm5lY3Rvci5kYXRhLm9uVmFsdWVDaGFuZ2UodmFsdWUgPT4ge1xyXG4gICAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVIdG1sKGRlZmF1bHRDb29yZGluYXRlcyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgbGF0TG5nID0gcGFyc2VMYXRMbmcodmFsdWUpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlSHRtbChsYXRMbmcpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUh0bWwobGF0TG5nOiBnb29nbGUubWFwcy5MYXRMbmdMaXRlcmFsKSB7XHJcbiAgICB0aGlzLmxhdENvbnRhaW5lci5pbm5lclRleHQgPSBsYXRMbmcubGF0ID8gbGF0TG5nLmxhdC50b1N0cmluZygpIDogJyc7XHJcbiAgICB0aGlzLmxuZ0NvbnRhaW5lci5pbm5lclRleHQgPSBsYXRMbmcubG5nID8gbGF0TG5nLmxuZy50b1N0cmluZygpIDogJyc7XHJcbiAgfVxyXG5cclxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcclxuICAgIGNvbnNvbGUubG9nKCdGaWVsZEN1c3RvbUdwc1ByZXZpZXcgZGlzY29ubmVjdGVkQ2FsbGJhY2sgY2FsbGVkJyk7XHJcbiAgfVxyXG59XHJcblxyXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ2ZpZWxkLWN1c3RvbS1ncHMtcHJldmlldycsIEZpZWxkQ3VzdG9tR3BzUHJldmlldyk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gXCJMYXQ6IDxzcGFuIGlkPVxcXCJsYXQtY29udGFpbmVyXFxcIj48L3NwYW4+LCBMbmc6IDxzcGFuIGlkPVxcXCJsbmctY29udGFpbmVyXFxcIj48L3NwYW4+XFxyXFxuXCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiXCIiXSwic291cmNlUm9vdCI6IiJ9