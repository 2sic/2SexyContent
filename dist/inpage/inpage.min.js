!function(){function a(a,b,c,d,e,f){return $2sxc._lib.extend({name:a,title:"Toolbar."+b,iclass:"icon-sxc-"+c,showOn:d,uiActionOnly:e},f)}$2sxc._actions={};$2sxc._actions.create=function(b){var c=b.canDesign,d={"dash-view":a("dash","Dashboard","","",!0,{inlineWindow:!0}),edit:a("edit","Edit","pencil","default",!1,{params:{mode:"edit"}}),"new":a("new","New","plus","default",!1,{params:{mode:"new"},dialog:"edit",addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder},code:function(a,b,c){c.openNgDialog($2sxc._lib.extend({},a,{sortOrder:a.sortOrder+1}),b)}}),add:a("add","AddDemo","plus-circled","edit",!1,{addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder},code:function(a,b,c){c.rootCB.addItem(a.sortOrder+1)}}),metadata:a("metadata","Metadata","tag","default",!1,{params:{mode:"new"},dialog:"edit",dynamicClasses:function(a){return a.entityId?"":"empty"},addCondition:function(a){return!!a.metadata},configureCommand:function(a){var b={Title:"EditFormTitle.Metadata",Metadata:$2sxc._lib.extend({keyType:"string",targetType:10},a.settings.metadata)};$2sxc._lib.extend(a.items[0],b)}}),remove:{title:"Toolbar.Remove",iclass:"icon-sxc-minus-circled",disabled:!0,showOn:"edit",addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder},code:function(a,b,c){confirm($2sxc.translate("Toolbar.ConfirmRemove"))&&c.rootCB.removeFromList(a.sortOrder)}},moveup:{title:"Toolbar.MoveUp",iclass:"icon-sxc-move-up",disabled:!1,showOn:"edit",addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder&&0!==a.sortOrder},code:function(a,b,c){c.rootCB.changeOrder(a.sortOrder,Math.max(a.sortOrder-1,0))}},movedown:{title:"Toolbar.MoveDown",iclass:"icon-sxc-move-down",disabled:!1,showOn:"edit",addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder},code:function(a,b,c){c.rootCB.changeOrder(a.sortOrder,a.sortOrder+1)}},sort:{title:"Toolbar.Sort",iclass:"icon-sxc-list-numbered",showOn:"edit",addCondition:function(a,b){return b.isList&&a.useModuleList&&-1!==a.sortOrder}},publish:a("publish","Published","eye","edit",!1,{iclass2:"icon-sxc-eye-off",disabled:!0,code:function(a,b,c){if(a.isPublished)return void alert($2sxc.translate("Toolbar.AlreadyPublished"));var d=-1===a.sortOrder?"listcontent":"content",e=-1===a.sortOrder?0:a.sortOrder;c.rootCB.publish(d,e)}}),replace:a("replace","Replace","replace","edit",!1,{addCondition:function(a){return a.useModuleList}}),layout:{title:"Toolbar.ChangeLayout",iclass:"icon-sxc-glasses",showOn:"default",uiActionOnly:!0,code:function(a,b,c){c.dialog?c.dialog.toggle():c.dialog=c.action({action:"dash-view"})}},develop:a("develop","Develop","code","admin",!0,{newWindow:!0,addCondition:c,configureCommand:function(a){a.items=[{EntityId:b.templateId}]}}),contenttype:{title:"Toolbar.ContentType",iclass:"icon-sxc-fields",showOn:"admin",uiActionOnly:!0,addCondition:c},contentitems:{title:"Toolbar.ContentItems",iclass:"icon-sxc-table",showOn:"admin",params:{contentTypeName:b.contentTypeId},uiActionOnly:!0,addCondition:c&&b.contentTypeId},app:{title:"Toolbar.App",iclass:"icon-sxc-settings",showOn:"admin",uiActionOnly:!0,addCondition:c},zone:{title:"Toolbar.Zone",iclass:"icon-sxc-manage",showOn:"admin",uiActionOnly:!0,addCondition:c},more:{title:"Toolbar.MoreActions",iclass:"icon-sxc-options btn-mode",showOn:"default,edit,design,admin",uiActionOnly:!0,code:function(a,b,d){var e=$(b.target).closest("ul.sc-menu"),f=Number(e.attr("data-state")||0),g=f+1;2===g&&(g=3),g%=c?4:3,e.removeClass("show-set-"+f).addClass("show-set-"+g).attr("data-state",g)}}};return d}}(),function(){$2sxc._lib={extend:function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}}}(),function(){$2sxc._toolbarManager=function(a,b,c){var d={getButton:function(c){c.entity&&c.entity._2sxcEditInformation&&(c.entity._2sxcEditInformation.entityId&&(c.entityId=c.entity._2sxcEditInformation.entityId,c.useModuleList=!1),c.entity._2sxcEditInformation.sortOrder&&(c.sortOrder=c.entity._2sxcEditInformation.sortOrder,c.useModuleList=!0),delete c.entity);for(var d=b[c.action],e="",f=d.showOn.split(","),g=$("<div/>"),h=$('<i class="'+d.iclass+'" aria-hidden="true"></i>'),i=0;i<f.length;i++)e+=" show-"+f[i];var j=$("<a />",{"class":"sc-"+c.action+" "+e+(d.dynamicClasses?" "+d.dynamicClasses(c):""),onclick:"javascript:$2sxc("+a+").manage.action("+JSON.stringify(c)+", event);",title:$2sxc.translate(d.title)});return"publish"===c.action&&c.isPublished===!1&&(j.addClass("show-default").removeClass("show-edit").attr("title",$2sxc.translate("Toolbar.Unpublished")),h.removeClass(d.iclass).addClass(d.iclass2)),j.html(g.html(h)),j[0].outerHTML},createDefaultToolbar:function(a){var d=[];d.add=function(e){var f=b[e].addCondition;(void 0===f||("function"==typeof f?f(a,c):f))&&d.push($2sxc._lib.extend({},a,{action:e}))};for(var e in b)b.hasOwnProperty(e)&&d.add(e);return d},getToolbar:function(a){for(var b=a.action?[a]:$.isArray(a)?a:d.createDefaultToolbar(a),c="sc-menu show-set-0"+(-1===a.sortOrder?" listContent":""),e=$("<ul />",{"class":c,onclick:"javascript: var e = arguments[0] || window.event; e.stopPropagation();"}),f=0;f<b.length;f++)e.append($("<li />").append($(d.getButton(b[f]))));return e[0].outerHTML},_processToolbars:function(){$(".sc-menu[data-toolbar]",$(".DnnModule-"+a)).each(function(){var b=$.parseJSON($(this).attr("data-toolbar"));$(this).replaceWith($2sxc(a).manage.getToolbar(b))})}};return d}}(),$2sxc.contentBlock=function(a,b){var c=".DnnModule-"+a.id+" .sc-viewport",d="_LayoutElement",e=b.editContext,f=""===e.ContentGroup.ContentTypeName&&null!==e.ContentGroup.TemplateId?d:e.ContentGroup.ContentTypeName,g={sxc:a,loading:0,editContext:e,templateId:e.ContentGroup.TemplateId,undoTemplateId:e.ContentGroup.TemplateId,contentTypeId:f,undoContentTypeId:f,replace:function(a){try{$(c).html(a),b._processToolbars()}catch(d){console.log("Error while rendering template:"),console.log(d)}},reload:function(b){if(b||(b=g.templateId),!b)return null;if(!g.editContext.ContentGroup.IsContent)return window.location.reload();g.templateId=b,console.log("new loading");var c=g.editContext.Language.Current;return g.loading++,a.webApi.get({url:"view/module/rendertemplate",params:{templateId:b,lang:c},dataType:"html"}).then(function(a){g.replace(a),g.loading--})},refresh:function(){g.reload()},publish:function(b,c){return a.webApi.get({url:"view/module/publish",params:{part:b,sortOrder:c}}).then(g.refresh)},removeFromList:function(b){return a.webApi.get({url:"view/module/removefromlist",params:{sortOrder:b}}).then(g.refresh)},changeOrder:function(b,c){return a.webApi.get({url:"view/module/changeorder",params:{sortOrder:b,destinationSortOrder:c}}).then(g.refresh)},setTemplateChooserState:function(b){return a.webApi.get({url:"View/Module/SetTemplateChooserState",params:{state:b}})},addItem:function(b){return a.webApi.get({url:"View/Module/AddItem",params:{sortOrder:b}}).then(g.refresh)},_saveTemplate:function(b,c,d){return a.webApi.get({url:"View/Module/SaveTemplateId",params:{templateId:b,forceCreateContentGroup:c,newTemplateChooserState:d}})},prepareToAddContent:function(){return g.persistTemplate(!0,!1)},persistTemplate:function(a,c){var d,e=!!g.editContext.ContentGroup.HasContent&&g.undoTemplateId===g.templateId;d=e?g.editContext.ContentBlock.ShowTemplatePicker?g.setTemplateChooserState(!1):$.when(null):g._saveTemplate(g.templateId,a,c).then(function(a,b,c){if(200!==c.status)return void alert("error - result not ok, was not able to create ContentGroup");var d=a;null!==d&&(d=d.replace(/[\",\']/g,""),console&&console.log("created content group {"+d+"}"))});var f=d.then(function(){g.undoTemplateId=g.templateId,g.undoContentTypeId=g.contentTypeId,g.editContext.ContentBlock.ShowTemplatePicker=!1,b.dialog&&b.dialog.justHide(),g.editContext.ContentGroup.HasContent||(g.editContext.ContentGroup.HasContent=a)});return f}};return g},$2sxc.translate=function(a){return a};var $2sxcActionMenuMapper=function(a){return{changeLayoutOrContent:function(){$2sxc(a).manage.action({action:"layout"})},addItem:function(){$2sxc(a).manage.action({action:"add",useModuleList:!0,sortOrder:0})},edit:function(){$2sxc(a).manage.action({action:"edit",useModuleList:!0,sortOrder:0})},adminApp:function(){$2sxc(a).manage.action({action:"app"})},adminZone:function(){$2sxc(a).manage.action({action:"zone"})},develop:function(){$2sxc(a).manage.action({action:"develop"})}}};!function(){var a=$2sxc.dialog={mode:"iframe",templates:{inline:"<iframe width='100%' height='200px' src='{{url}}'onresize=\"console.log('resize')\"></iframe>"}};a.create=function(b,c,d,e){c=$(c);var f=$(a.templates.inline.replace("{{url}}",d)),g=f[0];return g.closeCallback=e,g.sxc=$2sxc(b),g.getManageInfo=function(){return g.sxc.manage.dialogParameters},g.getCommands=function(){return g.vm},g.syncHeight=function(a){console.log("tried resize to "+a),g.style.height=a+"px"},g.toggle=function(){g.style.display="none"===g.style.display?"":"none",g.vm.toggle()},g.justHide=function(){g.style.display="none"},c.prepend(g),g}}(),function(){function a(a){return $("div[data-cb-id='"+a.cbid+"']")[0]}function b(b){var c=a(b).getAttribute("data-edit-context");return $.parseJSON(c||"")}function c(a,b){var c=$2sxc._lib.extend({},a.toolbarConfig,b),d={settings:c,items:c.items||[],params:$2sxc._lib.extend({dialog:c.dialog||c.action},c.params),addSimpleItem:function(){var a={},b=d.settings.contentType||d.settings.attributeSetName;d.settings.entityId&&(a.EntityId=d.settings.entityId),b&&(a.ContentTypeName=b),(a.EntityId||a.ContentTypeName)&&d.items.push(a)},addContentGroupItem:function(a,b,c,e,f){d.items.push({Group:{Guid:a,Index:b,Part:c,Add:e},Title:$2sxc.translate(f)})},addContentGroupItemSetsToEditList:function(a){var b=-1!==d.settings.sortOrder,c=b?d.settings.sortOrder:0,e=b?"":"List",f=e+"Content",g=e+"Presentation",h="new"===d.settings.action,i=d.settings.contentGroupId;d.addContentGroupItem(i,c,f.toLowerCase(),h,"EditFormTitle."+f),a&&d.addContentGroupItem(i,c,g.toLowerCase(),h,"EditFormTitle."+g)},generateLink:function(){if(d.settings.items||(d.settings.items=[]),d.settings.prefill)for(var b=0;b<d.items.length;b++)d.items[b].Prefill=d.settings.prefill;d.params.items=JSON.stringify(d.items);var c=a.editContext.Environment.SxcRootUrl+"desktopmodules/tosic_sexycontent/dist/dnn/ui.html?sxcver="+a.editContext.Environment.SxcVersion,e=$2sxc.urlParams.get("debug")?"&debug=true":"";return c+"#"+$.param(a.dialogParameters)+"&"+$.param(d.params)+e}};return d}$2sxc.getManageController=function(a,d){var e=b(d),f=e.Environment,g=e.ContentBlock,h=e.ContentGroup,i=e.Language,j=$(".DnnModule-"+a),k={zoneId:h.ZoneId,appId:h.AppId,tid:f.PageId,mid:f.InstanceId,lang:i.Current,langpri:i.Primary,langs:JSON.stringify(i.All),portalroot:f.WebsiteUrl,websiteroot:f.SxcRootUrl,user:{canDesign:e.User.CanDesign,canDevelop:e.User.CanDesign},approot:h.AppUrl||null},l={canDesign:e.User.CanDesign,templateId:h.TemplateId,contentTypeId:h.ContentTypeName},m={portalId:f.WebsiteId,tabId:f.PageId,moduleId:f.InstanceId,contentGroupId:h.Guid,appPath:h.AppUrl,isList:h.IsList,version:f.SxcVersion},n=$2sxc._actions.create(l),o=$2sxc._toolbarManager(a,n,m),p={isEditMode:function(){return f.IsEditable},dialogParameters:k,toolbarConfig:m,editContext:e,linkToNgDialog:function(a){var b=c(p,a);return b.settings.useModuleList?b.addContentGroupItemSetsToEditList(!0):b.addSimpleItem(),b.settings.configureCommand&&b.settings.configureCommand(b),b.generateLink()},openNgDialog:function(b,c,d){var e=function(){p.rootCB.reload(),d()},f=p.linkToNgDialog(b);return b.newWindow||c&&c.shiftKey?window.open(f):b.inlineWindow?$2sxc.dialog.create(a,j,f,e):$2sxc.totalPopup.open(f,e)},action:function(a,b){var c=n[a.action];a=$2sxc._lib.extend({},c,a),a.dialog||(a.dialog=a.action),a.code||(a.code=p.openNgDialog);var d=b||window.event;return c.uiActionOnly?a.code(a,d,p):void p.rootCB.prepareToAddContent().then(function(){return a.code(a,d,p)})},getButton:o.getButton,createDefaultToolbar:o.createDefaultToolbar,getToolbar:o.getToolbar,_processToolbars:o._processToolbars};return g.ShowTemplatePicker&&p.action({action:"layout"}),p.rootCB=$2sxc.contentBlock(d,p),p}}(),$(document).ready(function(){$(".sc-menu").click(function(a){a.stopPropagation()});var a=$("div[data-2sxc]");window.setTimeout(function(){a.each(function(){try{var a=$(this).data("2sxc").moduleId;$2sxc(a).manage._processToolbars()}catch(b){console&&console.error&&console.error(b)}})},0),window.EavEditDialogs=[]});
//# sourceMappingURL=inpage.min.js.map