!function(){function e(e,t,n,o,a,i){return $2sxc._lib.extend({name:e,title:"Toolbar."+t,iclass:"icon-sxc-"+n,showOn:o,uiActionOnly:a},i)}$2sxc._actions={};$2sxc._actions.create=function(t){var n=t.canDesign,o={"dash-view":e("dash","Dashboard","","",!0,{inlineWindow:!0}),"app-import":e("app-import","Dashboard","","",!0,{}),edit:e("edit","Edit","pencil","default",!1,{params:{mode:"edit"}}),"new":e("new","New","plus","default",!1,{params:{mode:"new"},dialog:"edit",addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder},code:function(e,t,n){n.commands._openNgDialog($2sxc._lib.extend({},e,{sortOrder:e.sortOrder+1}),t)}}),add:e("add","AddDemo","plus-circled","edit",!1,{addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder},code:function(e,t,n){n.contentBlock.addItem(e.sortOrder+1)}}),metadata:e("metadata","Metadata","tag","default",!1,{params:{mode:"new"},dialog:"edit",dynamicClasses:function(e){return e.entityId?"":"empty"},addCondition:function(e){return!!e.metadata},configureCommand:function(e){var t={Title:"EditFormTitle.Metadata",Metadata:$2sxc._lib.extend({keyType:"string",targetType:10},e.settings.metadata)};$2sxc._lib.extend(e.items[0],t)}}),remove:{title:"Toolbar.Remove",iclass:"icon-sxc-minus-circled",disabled:!0,showOn:"edit",addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder},code:function(e,t,n){confirm($2sxc.translate("Toolbar.ConfirmRemove"))&&n.contentBlock.removeFromList(e.sortOrder)}},moveup:{title:"Toolbar.MoveUp",iclass:"icon-sxc-move-up",disabled:!1,showOn:"edit",addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder&&0!==e.sortOrder},code:function(e,t,n){n.contentBlock.changeOrder(e.sortOrder,Math.max(e.sortOrder-1,0))}},movedown:{title:"Toolbar.MoveDown",iclass:"icon-sxc-move-down",disabled:!1,showOn:"edit",addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder},code:function(e,t,n){n.contentBlock.changeOrder(e.sortOrder,e.sortOrder+1)}},sort:{title:"Toolbar.Sort",iclass:"icon-sxc-list-numbered",showOn:"edit",addCondition:function(e,t){return t.isList&&e.useModuleList&&-1!==e.sortOrder}},publish:e("publish","Published","eye","edit",!1,{iclass2:"icon-sxc-eye-off",disabled:!0,code:function(e,t,n){if(e.isPublished)return void alert($2sxc.translate("Toolbar.AlreadyPublished"));var o=-1===e.sortOrder?"listcontent":"content",a=-1===e.sortOrder?0:e.sortOrder;n.contentBlock.publish(o,a)}}),replace:e("replace","Replace","replace","edit",!1,{addCondition:function(e){return e.useModuleList}}),layout:{title:"Toolbar.ChangeLayout",iclass:"icon-sxc-glasses",showOn:"default",uiActionOnly:!0,code:function(e,t,n){n.contentBlock.dialogToggle()}},develop:e("develop","Develop","code","admin",!0,{newWindow:!0,addCondition:n,configureCommand:function(e){e.items=[{EntityId:t.templateId}]}}),contenttype:{title:"Toolbar.ContentType",iclass:"icon-sxc-fields",showOn:"admin",uiActionOnly:!0,addCondition:n},contentitems:{title:"Toolbar.ContentItems",iclass:"icon-sxc-table",showOn:"admin",params:{contentTypeName:t.contentTypeId},uiActionOnly:!0,addCondition:n&&t.contentTypeId},app:{title:"Toolbar.App",iclass:"icon-sxc-settings",showOn:"admin",uiActionOnly:!0,addCondition:n},zone:{title:"Toolbar.Zone",iclass:"icon-sxc-manage",showOn:"admin",uiActionOnly:!0,addCondition:n},more:{title:"Toolbar.MoreActions",iclass:"icon-sxc-options btn-mode",showOn:"default,edit,design,admin",uiActionOnly:!0,code:function(e,t){var o=$(t.target).closest("ul.sc-menu"),a=Number(o.attr("data-state")||0),i=a+1;2===i&&(i=3),i%=n?4:3,o.removeClass("show-set-"+a).addClass("show-set-"+i).attr("data-state",i)}}};return o}}(),function(){$2sxc._contentManagementCommands=function(e,t){var n={editManager:"must-be-added-after-initialization",init:function(e){n.editManager=e},create:function(e){var t=$2sxc._lib.extend({},n.editManager.toolbarConfig,e),o=n.editManager.editContext.Environment.SxcRootUrl+"desktopmodules/tosic_sexycontent/dist/dnn/ui.html?sxcver="+n.editManager.editContext.Environment.SxcVersion,a=$2sxc.urlParams.get("debug")?"&debug=true":"",i={settings:t,items:t.items||[],params:$2sxc._lib.extend({dialog:t.dialog||t.action},t.params),addSimpleItem:function(){var e={},t=i.settings.contentType||i.settings.attributeSetName;i.settings.entityId&&(e.EntityId=i.settings.entityId),t&&(e.ContentTypeName=t),(e.EntityId||e.ContentTypeName)&&i.items.push(e)},addContentGroupItem:function(e,t,n,o,a,r,s){i.items.push({Group:{Guid:e,Index:t,Part:n,Add:o},Title:$2sxc.translate(s)})},addContentGroupItemSetsToEditList:function(e){var t=-1!==i.settings.sortOrder,n=t?i.settings.sortOrder:0,o=t?"":"List",a=o+"Content",r=o+"Presentation",s="new"===i.settings.action,d=i.settings.contentGroupId;i.addContentGroupItem(d,n,a.toLowerCase(),s,i.settings.cbIsEntity,i.settings.cbId,"EditFormTitle."+a),e&&i.addContentGroupItem(d,n,r.toLowerCase(),s,i.settings.cbIsEntity,i.settings.cbId,"EditFormTitle."+r)},generateLink:function(){if(i.settings.items||(i.settings.items=[]),i.settings.prefill)for(var e=0;e<i.items.length;e++)i.items[e].Prefill=i.settings.prefill;return i.params.items=JSON.stringify(i.items),o+"#"+$.param(n.editManager.dialogParameters)+"&"+$.param(i.params)+a}};return i},_linkToNgDialog:function(e){var t=n.editManager.commands.create(e);return t.settings.useModuleList?t.addContentGroupItemSetsToEditList(!0):t.addSimpleItem(),t.settings.configureCommand&&t.settings.configureCommand(t),t.generateLink()},_openNgDialog:function(o,a,i){var r=function(){n.editManager.contentBlock.reloadAndReInitialize(),i()},s=n._linkToNgDialog(o);return o.newWindow||a&&a.shiftKey?window.open(s):o.inlineWindow?$2sxc._dialog.create(e,t,s,r):$2sxc.totalPopup.open(s,r)},executeAction:function(e,t){var o=n.editManager.toolbar.actions[e.action];e=$2sxc._lib.extend({},o,e),e.dialog||(e.dialog=e.action),e.code||(e.code=n._openNgDialog);var a=t||window.event;return o.uiActionOnly?e.code(e,a,n.editManager):void n.editManager.contentBlock.prepareToAddContent().then(function(){return e.code(e,a,n.editManager)})}};return n}}(),function(){$2sxc._lib={extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]}}}(),function(){$2sxc._toolbarManager=function(e,t){function n(){var e={portalId:t.Environment.WebsiteId,tabId:t.Environment.PageId,moduleId:t.Environment.InstanceId,version:t.Environment.SxcVersion,contentGroupId:t.ContentGroup.Guid,cbIsEntity:t.ContentBlock.IsEntity,cbId:t.ContentBlock.Id,appPath:t.ContentGroup.AppUrl,isList:t.ContentGroup.IsList};return e}var o=e.id,a=e.cbid,i={canDesign:t.User.CanDesign,templateId:t.ContentGroup.TemplateId,contentTypeId:t.ContentGroup.ContentTypeName},r=$2sxc._actions.create(i),s={config:n(),refreshConfig:function(){s.config=n()},actions:r,getButton:function(e){if(e.entity&&e.entity._2sxcEditInformation){var t=e.entity._2sxcEditInformation;e.useModuleList=void 0!==t.sortOrder,void 0!==t.entityId&&(e.entityId=t.entityId),void 0!==t.sortOrder&&(e.sortOrder=t.sortOrder),delete e.entity}for(var n=r[e.action],i="",s=n.showOn.split(","),d=$("<div/>"),l=$('<i class="'+n.iclass+'" aria-hidden="true"></i>'),c=0;c<s.length;c++)i+=" show-"+s[c];var u=$("<a />",{"class":"sc-"+e.action+" "+i+(n.dynamicClasses?" "+n.dynamicClasses(e):""),onclick:"javascript:$2sxc("+o+", "+a+").manage.action("+JSON.stringify(e)+", event);","data-i18n":"[title]"+n.title});return"publish"===e.action&&e.isPublished===!1&&(u.addClass("show-default").removeClass("show-edit").attr("data-i18n","[title]Toolbar.Unpublished"),l.removeClass(n.iclass).addClass(n.iclass2)),u.html(d.html(l)),u[0].outerHTML},createDefaultToolbar:function(e){var t=[];t.add=function(n){var o=r[n].addCondition;(void 0===o||("function"==typeof o?o(e,s.config):o))&&t.push($2sxc._lib.extend({},e,{action:n}))};for(var n in r)r.hasOwnProperty(n)&&t.add(n);return t},getToolbar:function(e){for(var t=e.action?[e]:$.isArray(e)?e:s.createDefaultToolbar(e),n="sc-menu show-set-0"+(-1===e.sortOrder?" listContent":""),o=$("<ul />",{"class":n,onclick:"javascript: var e = arguments[0] || window.event; e.stopPropagation();"}),a=0;a<t.length;a++)o.append($("<li />").append($(s.getButton(t[a]))));return o[0].outerHTML},_processToolbars:function(e){e=e?$(e):$(".DnnModule-"+o),$(".sc-menu[data-toolbar]",e).each(function(){var e=$.parseJSON($(this).attr("data-toolbar")),t=$(this);t.replaceWith($2sxc(t).manage.getToolbar(e))})}};return s}}(),function(){var e=!1;$2sxc.translate=function(e){return $.t(e)},$2sxc._initTranslate=function(t){e||(window.i18next.use(window.i18nextXHRBackend).init({lng:t.editContext.Language.Current.substr(0,2),fallbackLng:"en",whitelist:["en","de","fr","it","uk","nl"],preload:["en"],backend:{loadPath:t.editContext.Environment.SxcRootUrl+"desktopmodules/tosic_sexycontent/dist/i18n/inpage-{{lng}}.js"}},function(e,t){jqueryI18next.init(i18next,$),$("ul.sc-menu").localize(),$(".sc-i18n").localize()}),e=!0)}}(),$2sxc.contentBlock=function(e,t,n){var o="_LayoutElement",a=t.editContext,i=""===a.ContentGroup.ContentTypeName&&null!==a.ContentGroup.TemplateId?o:a.ContentGroup.ContentTypeName,r={sxc:e,editContext:a,templateId:a.ContentGroup.TemplateId,undoTemplateId:a.ContentGroup.TemplateId,contentTypeId:i,undoContentTypeId:i,buttonsAreLoaded:!0,replace:function(e,t){try{var o=$(e);$(n).replaceWith(o),n=o,r.buttonsAreLoaded=!1}catch(a){console.log("Error while rendering template:"),console.log(a)}},replacePreview:function(e){r.replace(e,!0)},reloadAndReInitialize:function(n){return n&&(t.reloadWithAjax=!0),t.reloadWithAjax?(n?r.reload(-1):r.reload()).then(function(){t.reloadWithAjax&&e.manage.dialog&&e.manage.dialog.destroy(),r.sxc=r.sxc.recreate(),r.sxc.manage.toolbar._processToolbars(),r.buttonsAreLoaded=!0}):window.location.reload()},reload:function(e){return e||(e=r.templateId),e?t.reloadWithAjax?(r.templateId=e,r._getPreviewWithTemplate(e).then(r.replace)):window.location.reload():null},publish:function(e,t){return r.sxc.webApi.get({url:"view/module/publish",params:{part:e,sortOrder:t}}).then(r.reloadAndReInitialize)},removeFromList:function(e){return r.sxc.webApi.get({url:"view/module/removefromlist",params:{sortOrder:e}}).then(r.reloadAndReInitialize)},changeOrder:function(e,t){return r.sxc.webApi.get({url:"view/module/changeorder",params:{sortOrder:e,destinationSortOrder:t}}).then(r.reloadAndReInitialize)},addItem:function(e){return r.sxc.webApi.get({url:"View/Module/AddItem",params:{sortOrder:e}}).then(r.reloadAndReInitialize)},_getPreviewWithTemplate:function(e){return r.sxc.webApi.get({url:"view/module/rendertemplate",params:{templateId:e,lang:r.editContext.Language.Current,cbisentity:a.ContentBlock.IsEntity,cbid:a.ContentBlock.Id,originalparameters:JSON.stringify(a.Environment.parameters)},dataType:"html"})},_setTemplateChooserState:function(e){return r.sxc.webApi.get({url:"view/module/SetTemplateChooserState",params:{state:e}})},_saveTemplate:function(e,t,n){return r.sxc.webApi.get({url:"view/module/savetemplateid",params:{templateId:e,forceCreateContentGroup:t,newTemplateChooserState:n}})},_cancelTemplateChange:function(){r.templateId=r.undoTemplateId,r.contentTypeId=r.undoContentTypeId,e.manage.dialog.justHide(),r._setTemplateChooserState(!1).then(r.reloadAndReInitialize)},dialogToggle:function(){var e=t.dialog;e?e.toggle():e=t.dialog=t.action({action:"dash-view"});var n=e.isVisible();t.editContext.ContentBlock.ShowTemplatePicker!==n&&r._setTemplateChooserState(n).then(function(){t.editContext.ContentBlock.ShowTemplatePicker=n})},prepareToAddContent:function(){return r.persistTemplate(!0,!1)},persistTemplate:function(e,n){var o,a=!!r.editContext.ContentGroup.HasContent&&r.undoTemplateId===r.templateId;o=a?r.editContext.ContentBlock.ShowTemplatePicker?r._setTemplateChooserState(!1):$.when(null):r._saveTemplate(r.templateId,e,n).then(function(e,n,o){if(200!==o.status)return void alert("error - result not ok, was not able to create ContentGroup");var a=e;a&&(a=a.replace(/[\",\']/g,""),console&&console.log("created content group {"+a+"}"),t.updateContentGroupGuid(a))});var i=o.then(function(){r.undoTemplateId=r.templateId,r.undoContentTypeId=r.contentTypeId,r.editContext.ContentBlock.ShowTemplatePicker=!1,t.dialog&&t.dialog.justHide(),r.editContext.ContentGroup.HasContent||(r.editContext.ContentGroup.HasContent=e),(!r.buttonsAreLoaded||!a&&t.reloadWithAjax)&&r.reloadAndReInitialize()});return i}};return r},function(){function e(e){return $("div[data-cb-id='"+e.cbid+"']")[0]}function t(e){var t=e.getAttribute("data-edit-context");return $.parseJSON(t||"")}$2sxc.getManageController=function(n){var o=e(n),a=t(o),i={zoneId:a.ContentGroup.ZoneId,appId:a.ContentGroup.AppId,tid:a.Environment.PageId,mid:a.Environment.InstanceId,cbid:n.cbid,lang:a.Language.Current,langpri:a.Language.Primary,langs:JSON.stringify(a.Language.All),portalroot:a.Environment.WebsiteUrl,websiteroot:a.Environment.SxcRootUrl,user:{canDesign:a.User.CanDesign,canDevelop:a.User.CanDesign},approot:a.ContentGroup.AppUrl||null},r={appId:a.ContentGroup.AppId,isContent:a.ContentGroup.IsContent,hasContent:a.ContentGroup.HasContent,isList:a.ContentGroup.IsList,templateId:a.ContentGroup.TemplateId,contentTypeId:a.ContentGroup.ContentTypeName,templateChooserVisible:a.ContentBlock.ShowTemplatePicker,user:{canDesign:a.User.CanDesign,canDevelop:a.User.CanDesign},supportsAjax:a.ContentGroup.SupportsAjax},s=$2sxc._toolbarManager(n,a),d=$2sxc._contentManagementCommands(n,o),l={isEditMode:function(){return a.Environment.IsEditable},reloadWithAjax:a.ContentGroup.SupportsAjax,dialogParameters:i,toolbarConfig:s.config,editContext:a,dashboardConfig:r,commands:d,action:d.executeAction,toolbar:s,getButton:s.getButton,createDefaultToolbar:s.createDefaultToolbar,getToolbar:s.getToolbar,init:function(){a.error.type&&l.handleErrors(a.error.type,o),l.commands.init(l),l.contentBlock=$2sxc.contentBlock(n,l,o),!a.error.type&&a.ContentBlock.ShowTemplatePicker&&l.action({action:"layout"})},handleErrors:function(e,t){var n=$('<div class="dnnFormMessage dnnFormWarning sc-element"></div>'),o="",a=$("<ul class='sc-menu'></ul>"),i=[];"DataIsMissing"===e&&(o="Error: System.Exception: Data is missing - usually when a site is copied but the content / apps have not been imported yet - check 2sxc.org/help?tag=export-import",i=["zone","more"],a.attr("data-toolbar",'[{"action": "zone"}, {"action": "more"}]')),n.append(o),n.append(a),$(t).append(n)},updateContentGroupGuid:function(e){a.ContentGroup.Guid=e,s.refreshConfig(),l.toolbarConfig=s.config},createContentBlock:function(e,t,o,a,i){var r=i;if(0===r.length)return alert("can't add content-block as we couldn't find the list");var s=r.find("div.sc-content-block");return o>s.length&&(o=s.length),n.webApi.get({url:"view/module/generatecontentblock",params:{parentId:e,field:t,sortOrder:o,app:a}}).then(function(e){var t=$(e);s.length>0&&o>0?$(s[s.length>o-1?o-1:s.length-1]).after(t):r.prepend(t);var n=$2sxc(t);n.manage.toolbar._processToolbars(t)})},moveContentBlock:function(e,t,o,a){return n.webApi.get({url:"view/module/MoveItemInList",params:{parentId:e,field:t,indexFrom:o,indexTo:a}}).then(function(){console.log("done moving!"),window.location.reload()})},deleteContentBlock:function(e,t,o){return confirm($2sxc.translate("QuickInsertMenu.ConfirmDelete"))?n.webApi.get({url:"view/module/RemoveItemInList",params:{parentId:e,field:t,index:o}}).then(function(){console.log("done deleting!"),window.location.reload()}):null}};return l.init(),l}}(),function(){var e=$2sxc._dialog={mode:"iframe",templates:{inline:"<iframe width='100%' height='100px' src='{{url}}'onresize=\"console.log('resize')\"></iframe>"}};e.create=function(t,n,o,a){function i(){r.syncHeight(),r.resizeInterval=window.setInterval(r.syncHeight,200)}var r=$(e.templates.inline.replace("{{url}}",o))[0];return r.closeCallback=a,r.sxc=t,r.getManageInfo=function(){return r.sxc.manage.dialogParameters},r.getAdditionalDashboardConfig=function(){return r.sxc.manage.dashboardConfig},r.getCommands=function(){return r.vm},r.syncHeight=function(){var e=r.contentDocument.body.offsetHeight;r.previousHeight!==e&&(window.diagBox=r,r.height=e+"px",r.previousHeight=e)},r.addEventListener("load",i),r.isVisible=function(){return"none"!==r.style.display},r.toggle=function(){r.style.display="none"===r.style.display?"":"none"},r.justHide=function(){r.style.display="none"},r.destroy=function(){window.clearInterval(r.resizeInterval),r.remove()},$(n).before(r),r}}();var $2sxcActionMenuMapper=function(e){return{changeLayoutOrContent:function(){$2sxc(e).manage.action({action:"layout"})},addItem:function(){$2sxc(e).manage.action({action:"add",useModuleList:!0,sortOrder:0})},edit:function(){$2sxc(e).manage.action({action:"edit",useModuleList:!0,sortOrder:0})},adminApp:function(){$2sxc(e).manage.action({action:"app"})},adminZone:function(){$2sxc(e).manage.action({action:"zone"})},develop:function(){$2sxc(e).manage.action({action:"develop"})}}};$(document).ready(function(){$(".sc-menu").click(function(e){e.stopPropagation()});var e=$("div[data-edit-context]");console&&console.log("found "+e.length+" content blocks"),window.setTimeout(function(){e.each(function(){try{$2sxc(this).manage.toolbar._processToolbars(this)}catch(e){console&&console.error&&console.error(e)}})},0),window.EavEditDialogs=[]}),$(function(){"use strict";function e(e,t,n,o,a,i){return"<a class='sc-content-block-menu-btn sc-cb-action icon-sxc-"+t+" "+(o?" sc-invisible ":"")+(a?" sc-unavailable ":"")+i+"' data-action='"+e+"' data-i18n='[title]QuickInsertMenu."+n+"'></a>"}var t={cb:{id:"cb","class":"sc-content-block",selector:".sc-content-block",listSelector:".sc-content-block-list",context:"data-list-context"},mod:{id:"mod","class":"DnnModule",selector:".DnnModule",listSelector:".DNNEmptyPane, .dnnDropEmptyPanes, :has(>.DnnModule)",context:null},eitherCbOrMod:".DnnModule, .sc-content-block",selected:"sc-cb-is-selected"},n=$(t.cb.listSelector).length>0,o={enableCb:n,enableMod:!n,body:$("body"),win:$(window),main:$("<div class='sc-content-block-menu sc-content-block-quick-insert sc-i18n'></div>"),template:"<a class='sc-content-block-menu-addcontent sc-invisible' data-type='Default' data-i18n='[titleTemplate]QuickInsertMenu.AddBlockContent'>x</a><a class='sc-content-block-menu-addapp sc-invisible' data-type='' data-i18n='[titleTemplate]QuickInsertMenu.AddBlockApp'>x</a>"+e("select","ok","Select",!0)+e("paste","paste","Paste",!0,!0),selected:$("<div class='sc-content-block-menu sc-content-block-selected-menu sc-i18n'></div>").append(e("delete","trash-empty","Delete")),contentBlocks:null,modules:null,nearestCb:null,nearestMod:null};$2sxc._lib.extend(o,{cbActions:$(o.template),modActions:$(o.template.replace(/QuickInsertMenu.AddBlock/g,"QuickInsertMenu.AddModule")).attr("data-context","module").addClass("sc-content-block-menu-module")}),o.init=function(){o.body.append(o.main),o.body.append(o.selected),o.enableCb&&o.main.append(o.cbActions),o.enableMod&&o.main.append(o.modActions)},o.init(),o.selected.toggle=function(e){if(!e)return o.selected.hide();var t=o.getCoordinates(e);t.yh=t.y+20,o.positionAndAlign(o.selected,t),o.selected.target=e},$("a",o.selected).click(function(){var e=$(this).data("action"),t=o.clipboard.data;switch(e){case"cancel":return o.clipboard.clear();case"delete":o.cmds[t.type]["delete"](t)}}),o.cmds={cb:{"delete":function(e){return $2sxc(e.list).manage.deleteContentBlock(e.parent,e.field,e.index)}},mod:{"delete":function(e){alert("module delete not implemented yet")},move:function(e,t){}}},o.cbActions.click(function(){var e=o.main.actionsForCb.closest(t.cb.listSelector),n=e.find(t.cb.selector),a=JSON.parse(e.attr(t.cb.context)),i=0;o.main.actionsForCb.hasClass(t.cb["class"])&&(i=n.index(o.main.actionsForCb[0])+1);var r=$(this).data("action");if(r)return o.copyPasteInPage(r,e,i,t.cb.id);var s=$(this).data("type");return $2sxc(e).manage.createContentBlock(a.parent,a.field,i,s,e)}),o.copyPasteInPage=function(e,t,n,a){var i=o.clipboard.createSpecs(a,t,n);if("select"===e)o.clipboard.mark(i);else if("paste"===e){var r=o.clipboard.data.index,s=i.index;if(isNaN(r)||isNaN(s)||r===s||r+1===s)return o.clipboard.clear();$2sxc(t).manage.moveContentBlock(i.parent,i.field,r,s),o.clipboard.clear()}},o.clipboard={data:{},mark:function(e){if(e){if(o.clipboard.data&&o.clipboard.data.item===e.item)return o.clipboard.clear();o.clipboard.data=e}$("."+t.selected).removeClass(t.selected);var n=$(o.clipboard.data.item);n.addClass(t.selected),n.prev().is("iframe")&&n.prev().addClass(t.selected),o.setSecondaryActionsState(!0),o.selected.toggle(n)},clear:function(){$("."+t.selected).removeClass(t.selected),o.clipboard.data=null,o.setSecondaryActionsState(!1),o.selected.toggle(!1)},createSpecs:function(e,n,o){var a=n.find(t[e].selector);o>=a.length&&(o=a.length-1);var i=a[o],r=JSON.parse(n.attr(t.cb.context)||null)||{parent:"dnn",field:n.id};return{parent:r.parent,field:r.field,list:n,item:i,index:o,type:e}}},o.setSecondaryActionsState=function(e){var t=$("a.sc-content-block-menu-btn");t=t.filter(".icon-sxc-paste"),t.toggleClass("sc-unavailable",!e)},o.modActions.click(function(){var e=$(this).data("type"),n=o.main.actionsForModule.closest(t.mod.listSelector),a=n.attr("id").replace("dnn_",""),i=0;o.main.actionsForModule.hasClass("DnnModule")&&(i=n.find(".DnnModule").index(o.main.actionsForModule[0])+1);var r=$(this).data("action");if(r)return o.copyPasteInPage(r,n,i,t.mod.id);var s=$.dnnSF(),d=s.getServiceRoot("internalservices")+"controlbar/",l=function(e){alert("Error while adding module."),console.log(e)};$.ajax({url:d+"GetPortalDesktopModules",type:"GET",data:"category=All&loadingStartIndex=0&loadingPageSize=100&searchTerm=",beforeSend:s.setModuleHeaders,success:function(t){var n="Default"===e?" Content":" App",o=null;if(t.forEach(function(e,t){e.ModuleName===n&&(o=e)}),!o)return alert(n+" module not found.");var r={Module:o.ModuleID,Page:"",Pane:a,Position:-1,Sort:i,Visibility:0,AddExistingModule:!1,CopyModule:!1};$.ajax({url:d+"AddModule",type:"POST",data:r,beforeSend:s.setModuleHeaders,success:function(e){window.location.reload()},error:l})},error:l})});var a=null;$("body").on("mousemove",function(e){null===a&&(a=window.setTimeout(function(){requestAnimationFrame(function(){o.refresh(e),a=null})},20))}),o.getBodyPosition=function(){var e=o.body.css("position");return"relative"===e||"absolute"===e?{x:o.body.offset().left,y:o.body.offset().top}:{x:0,y:0}},o.bodyOffset=o.getBodyPosition(),o.refreshDomObjects=function(){o.bodyOffset=o.getBodyPosition(),o.cachedPanes||(o.cachedPanes=$(t.mod.listSelector)),o.enableCb&&(o.contentBlocks=$(t.cb.listSelector).find(t.cb.selector).add(t.cb.listSelector)),o.enableMod&&(o.modules=o.cachedPanes.find(t.mod.selector).add(o.cachedPanes))},o.positionAndAlign=function(e,t){return e.css({left:t.x-o.bodyOffset.x,top:t.yh-o.bodyOffset.y,width:t.element.width()}).show()},o.refresh=function(e){if((!o.refreshDomObjects.lastCall||new Date-o.refreshDomObjects.lastCall>1e3)&&(o.refreshDomObjects.lastCall=new Date,o.refreshDomObjects()),o.enableCb&&o.contentBlocks&&(o.nearestCb=o.findNearest(o.contentBlocks,{x:e.clientX,y:e.clientY},t.cb.selector)),o.enableMod&&o.modules&&(o.nearestMod=o.findNearest(o.modules,{x:e.clientX,y:e.clientY},t.mod.selector)),o.modActions.toggleClass("sc-invisible",null===o.nearestMod),o.cbActions.toggleClass("sc-invisible",null===o.nearestCb),o.main.parentContainer&&$(o.main.parentContainer).removeClass("sc-cb-highlight-for-insert"),null!==o.nearestCb||null!==o.nearestMod){var n=o.nearestCb||o.nearestMod,a=$(n.element).closest(t.mod.listSelector),i=$(n.element).closest(t.cb.listSelector),r=(i.length?i:a)[0];if(a.length>0){var s=a.attr("id")||"";s.length>4&&(s=s.substr(4)),o.modActions.filter("[titleTemplate]").each(function(){var e=$(this);e.attr("title",e.attr("titleTemplate").replace("{0}",s))})}o.positionAndAlign(o.main,n,!0),o.main.actionsForCb=o.nearestCb?o.nearestCb.element:null,o.main.actionsForModule=o.nearestMod?o.nearestMod.element:null,o.main.parentContainer=r,$(r).addClass("sc-cb-highlight-for-insert")}else o.main.hide()},o.findNearest=function(e,t){var n=30,a=null,i=n,r=t.x+o.win.scrollLeft(),s=t.y+o.win.scrollTop();return e.each(function(){var e=o.getCoordinates($(this));if(!(r<e.x||r>e.x+e.w)){var t=Math.abs(s-e.yh);n>t&&i>t&&(a=e,i=t)}}),a},o.getCoordinates=function(e){return{element:e,x:e.offset().left,w:e.width(),y:e.offset().top,yh:e.offset().top+(e.is(t.eitherCbOrMod)?e.height():0)}}});
//# sourceMappingURL=inpage.min.js.map
